
(function(){var mods=[],version=parseFloat(seajs.version);define(["lib","common","$"],function(require,exports,module){var uri=module.uri||module.id,m=uri.split('?')[0].match(/^(.+\/)([^\/]*?)(?:\.js)?$/i),root=m&&m[1],name=m&&('./'+m[2]),i=0,len=mods.length,curr,args,undefined;for(;i<len;i++){args=mods[i];if(typeof args[0]==='string'){name===args[0]&&(curr=args[2]);args[0]=root+args[0].replace('./','');(version>1.0)&&define.apply(this,args);}}
mods=[];require.get=require;return typeof curr==='function'?curr.apply(this,arguments):require;});define.pack=function(){mods.push(arguments);(version>1.0)||define.apply(null,arguments);};})();define.pack("./cgi_ret_report",["lib","common","$"],function(require,exports,module){var lib=require('lib'),common=require('common'),constants=common.get('./constants'),$=require('$'),url_parser=lib.get('./url_parser'),image_loader=lib.get('./image_loader'),urls=common.get('./urls'),type_ok=1,type_err=2,type_logic_err=3,ret_rate=1,report_cgi='http://c.isdspeed.qq.com/code.cgi',ok_rets={0:1},logic_error_rets={1010:1,1016:1,1018:1,1019:1,1020:1,1021:1,1022:1,1024:1,1026:1,1027:1,1028:1,1029:1,1030:1,1031:1,1032:1,1033:1,1034:1,1035:1,1051:1,1052:1,1053:1,1054:1,1055:1,1056:1,1057:1,1058:1,1059:1,1060:1,1061:1,1062:1,1063:1,1064:1,1065:1,1070:1,1073:1,1074:1,1075:1,1076:1,1083:1,1088:1,1091:1,1092:1,1095:1,1105:1,1106:1,1107:1,1111:1,1112:1,1113:1,1116:1,1119:1,1120:1,1117:1,3002:1,3008:1,100028:1,100029:1,190041:1},set_timeout=setTimeout,undefined;var cgi_ret_report={report:function(cgi_url,cmd,ret,time){if(!cgi_url){return;}
set_timeout(function(){var url=url_parser.parse(cgi_url),cgi_name=url.pathname.replace(/^\//,'');var result_type;if(ret in ok_rets){result_type=type_ok;}else if(ret in logic_error_rets){result_type=type_ok;}else{result_type=type_err;}
image_loader.load(urls.make_url(report_cgi,{uin:common.get('./query_user').get_uin_num()||undefined,domain:url.host,cgi:cgi_name+(cmd?'?cmd='+cmd:''),type:result_type,code:ret,time:time,rate:ret_rate}));},500);}};return cgi_ret_report;});define.pack("./configs.aid",[],function(require,exports,module){return{WEIYUN_WEBAPP_DISK_HELP:'weiyun.webapp.disk.help',WEBAPP_DISK_GUANWANG:'webapp.disk.guanwang',WEIYUN_WEBAPP_DISK_FANKUI:'weiyun.webapp.disk.fankui',WEBAPP_DISK_PHOTO:'webapp.disk.photo',APPBOX_DISK_PHOTO:'appbox.disk.photo',WEIYUN_APPBOX_DISK_FANKUI:'weiyun.appbox.disk.fankui',WEIYUN_WEBAPP_DISK_LIJIANZHUANG:'weiyun.webapp.disk.lijianzhuang',WEBAPP_DISK_LOGO:'webapp.disk.logo',WEIYUN_APP_WEB_LOGIN:'weiyun.app.web.login',WEIYUN_APP_WEB_DISK:'weiyun.app.web.disk',WEIYUN_APP_WEB_PHOTO:'weiyun.app.web.photo',WEIYUN_APP_APPBOX:'weiyun.app.appbox'};});define.pack("./configs.click_tj",["lib","common"],function(require,exports,module){var
lib=require('lib'),common=require('common'),console=lib.get('./console'),ops=common.get('./configs.ops');return{make_tj_str:function(op_name){var tj_id=ops.get_click_op_by_name(op_name);if(tj_id){return'data-tj-action="btn-adtag-tj" data-tj-value="'+tj_id+'"';}else{return'';}},with_$el:function($el,op_name){var tj_id=ops.get_click_op_by_name(op_name);if(tj_id){$el.attr('data-tj-action','btn-adtag-tj').attr('data-tj-value',tj_id);}}};});define.pack("./configs.ops",["lib"],function(require,exports,module){var
lib=require('lib'),console=lib.get('./console'),request_ops={query_user:{m_speed_flags:'7830-4-2-3'},pwd_vry:{oz_op:9121,m_speed_flags:'7830-4-2-4'},get_dir_list:{m_speed_flags:'7830-4-1-1'},create_linker:{oz_op:9032,m_speed_flags:'7830-4-1-5'},dir_attr_mod:{oz_op:9015,m_speed_flags:'7830-4-1-6'},file_attr_mod:{oz_op:9015,m_speed_flags:'7830-4-1-6'},dir_create:{oz_op:9014,m_speed_flags:'7830-4-1-7'},batch_folder_move:{m_speed_flags:'7830-4-1-8'},batch_file_move:{m_speed_flags:'7830-4-1-8'},batch_folder_delete:{m_speed_flags:'7830-4-1-9'},batch_file_delete:{m_speed_flags:'7830-4-1-9'},add_share:{m_speed_flags:'7830-4-1-11'},recycle_query_list:{oz_op:9118,m_speed_flags:'7830-4-3-1'},recycle_clear:{oz_op:9120,m_speed_flags:'7830-4-3-4'},recycle_restore_files:{m_speed_flags:'7830-4-3-5'}},click_ops={INDEP_PWD:50002,LOGIN_OUT:50006,HEADER_HELP:50001,HEADER_FANKUI:50003,HEADER_GUANWANG:50004,NAV_DISK:50201,NAV_RECYCLE:50202,NAV_PHOTO:50205,NAV_RECENT:50203,HEADER_USER_FACE_HOVER:50100,HEADER_USER_FACE_DOWNLOAD_CLIENT:50101,HEADER_USER_FACE_FEEDBACK:50003,TOOLBAR_UPLOAD:52101,TOOLBAR_DOWNLOAD:52102,TOOLBAR_DOWNLOAD_BACK:52103,TOOLBAR_DOWNLOAD_OK:52104,TOOLBAR_MANAGE:52105,TOOLBAR_MANAGE_MOVE:52106,TOOLBAR_MANAGE_MOVE_BACK:52107,TOOLBAR_MANAGE_MOVE_OK:52108,TOOLBAR_MANAGE_MOVE_EXPAND_DIR:52109,TOOLBAR_MANAGE_DELETE:52110,TOOLBAR_MANAGE_DELETE_BACK:52111,TOOLBAR_MANAGE_DELETE_OK:52112,TOOLBAR_MANAGE_MKDIR:52113,TOOLBAR_RECYCLE:52114,TOOLBAR_RECYCLE_BACK:52115,TOOLBAR_RECYCLE_RESTORE:52116,TOOLBAR_RECYCLE_CLEAR:52117,TOOLBAR_REFRESH:52118,DISK_BREAD_DIR:52201,DISK_BREAD_WEIYUN:52202,SWITCH_AZLIST_MODE:52203,SWITCH_NEWESTLIST_MODE:52204,SWITCH_NEWTHUMB_MODE:52205,FOLDER_ICON:52301,FOLDER_NAME:52302,ITEM_RENAME:52303,ITEM_DELETE:52304,FILE_ICON:52305,FILE_NAME:52306,ITEM_DOWNLOAD:52307,FILE_MENU_MORE:52308,MORE_MENU_LINK_SHARE:52309,MORE_MENU_DELETE:52310,MORE_MENU_MAIL_SHARE:52311,MORE_MENU_RENAME:52312,DISK_DRAG_RELEASE:52313,DISK_DRAG_DIR:52314,DISK_DRAG_BREAD:52315,RIGHTKEY_MENU:52401,RIGHTKEY_MENU_DOWNLOAD:52402,RIGHTKEY_MENU_MAIL_SHARE:52403,RIGHTKEY_MENU_LINK_SHARE:52404,RIGHTKEY_MENU_MOVE:52405,RIGHTKEY_MENU_RENAME:52406,RIGHTKEY_MENU_DELETE:52407,DISK_PLUGIN_INSTALL:52501,DISK_PLUGIN_REINSTALL:52502,DISK_PLUGIN_INSTALLED:52503,DISK_UPLOAD_DONE:52504,DISK_UPLOAD_SLIDE_UP:52505,DISK_UPLOAD_PAUSE:52506,DISK_UPLOAD_CANCEL:52507,DISK_UPLOAD_CONTIUNE:52508,DISK_UPLOAD_RESUME_CONTIUNE:52514,DISK_UPLOAD_HAS_DATA_CANCEL:52509,UPLOAD_DOWN_BAR_CLOSE:52510,UPLOAD_DOWN_BAR_OPEN_DIR:52511,DISK_DRAG_UPLOAD:52512,DISK_DRAG_DOWNLOAD:52513,VRY_INDEP_PWD:52601,TO_TOP:52602,BOX_SELECTION:52603,RECENT_DOWNLOAD_BTN:57001,RECENT_CLICK_ITEM:57002,RECENT_LOAD_MORE:57003,RECENT_REFRESH_BTN:50204,IMAGE_PREVIEW_DOWNLOAD:52610,IMAGE_PREVIEW_REMOVE:52611,IMAGE_PREVIEW_RAW:52612,IMAGE_PREVIEW_NAV_PREV:52613,IMAGE_PREVIEW_NAV_NEXT:52614,IMAGE_PREVIEW_CLOSE:52615,COMPRESS_DOWNLOAD:52701,COMPRESS_PREV:52702,COMPRESS_ENTER:52703,COMPRESS_CLOSE:52704,ITEM_CLICK_DOWNLOAD:52390,ITEM_CLICK_DOC_PREVIEW:52391,ITEM_CLICK_IMAGE_PREVIEW:52393,ITEM_CLICK_ZIP_PREVIEW:52392},manual_ops={disk_file_list_reload:9012,disk_toolbar_download:9132,disk_toolbar_file_move:9128,disk_toolbar_file_remove:9129,disk_contextmenu_download:9131,disk_contextmenu_file_move:9133,disk_contextmenu_file_remove:9135,disk_drag_file_move:9134,disk_switch_list_view:9103,document_preview:9130,image_preview:9130,down_windows_client:9115,down_ios_client:9116,down_android_client:9117,verify_indep_pwd:9121,disk_qq_upload_2_wy:9138,disk_drag_upload:9139,recycle_restore_files:9119,click_5g_ad:9109,close_5g_ad:9110,active_plugin:9136,webkit_plugin:9136,upload_flash:9137,upload_form:9138,upload_from_QQClient:20003,view_from_QQClient:20005,download_hijack_check:405,webkit_donwload:515,header_ad_link_web:69000,header_ad_link_appbox:69001,re_try_flag:59001};return{get_oz_op:function(cmd){var conf=cmd in request_ops?request_ops[cmd]:null;if(conf){if(typeof conf==='number'){return conf;}else if(typeof conf==='object'){return conf.oz_op;}}
return null;},get_oz_op_by_name:function(op_name){if(op_name in manual_ops){return manual_ops[op_name];}
return'';},get_m_speed_flags:function(cmd){var conf=cmd in request_ops?request_ops[cmd]:null;if(conf&&typeof conf==='object'){return conf.m_speed_flags;}
return'';},get_click_op_by_name:function(click_op_name){if(click_op_name in click_ops){return click_ops[click_op_name];}
return'';}};});define.pack("./constants",["lib","$"],function(require,exports,module){var
lib=require('lib'),$=require('$'),url=lib.get('./url_parser').get_cur_url(),collections=lib.get('./collections'),IS_APPBOX=url.has_param('appbox'),IS_QZONE=!IS_APPBOX&&url.has_param('qzone'),QQDISK_DIR_ID='77c92765438ca4ef1d170515',NET_FAV_DIR_ID='9b7db5fb4f26f2baea50ef60',os_name=(function(){var nav=navigator.userAgent.toLowerCase(),mappings=[['ipad','ipad'],['iphone','iphone'],['mac','mac os,macintosh'],['windows phone','windows phone'],['windows','windows'],['android','android'],['linux','linux'],['unix','unix'],['symbian','symbian'],['blackberry','bb10,blackberry,playbook']];for(var i=0,l=mappings.length;i<l;i++){var map=mappings[i],os_name=map[0],uas=map[1].split(',');if(collections.any(uas,function(ua){return nav.indexOf(ua)!==-1;})){return os_name;}}
return'unknown os';})(),browser_name=(function(b){if(b.msie){return'ie';}else if(b.chrome){return'chrome';}else if(b.mozilla){return'mozilla';}else if(b.safari){return'safari';}else if(b.webkit){return'webkit';}else{return'unknown';}})($.browser),undefined;var OS_TYPES={WEB:30013,APPBOX:30012,QQ:9,QZONE:30225};return{MAIN_DOMAIN:'weiyun.com',DOMAIN:'http://www.weiyun.com',WEB_ROOT:'http://www.weiyun.com/v2',IS_DEBUG:url.has_param('debug'),IS_APPBOX:IS_APPBOX,IS_WEBKIT_APPBOX:IS_APPBOX&&$.browser.webkit,IS_QZONE:IS_QZONE,IS_WRAPPED:IS_QZONE,APPID:IS_APPBOX?OS_TYPES.APPBOX:(IS_QZONE?OS_TYPES.QZONE:OS_TYPES.WEB),OS_NAME:os_name,OS_TYPES:OS_TYPES,BROWSER_NAME:browser_name,RESOURCE_BASE:'http://imgcache.qq.com/vipstyle/nr/box',QQDISK_DIR_ID:QQDISK_DIR_ID,NET_FAV_DIR_ID:NET_FAV_DIR_ID,SERVICE_ID:{DISK:1,PHOTO:2}};});define.pack("./file.file_object",["$","lib","common","./file.file_type_map"],function(require,exports,module){var
$=require('$'),lib=require('lib'),common=require('common'),collections=lib.get('./collections'),console=lib.get('./console'),text=lib.get('./text'),constants=common.get('./constants'),BYTE_UNITS=['B','K','M','G','T','E','Z','Y','B','...'],EXT_IMAGE_TYPES={jpg:1,jpeg:1,gif:1,png:1,bmp:1},EXT_PREVIEW_DOC_TYPES={xls:1,xlsx:1,doc:1,docx:1,rtf:1,wps:1,ppt:1,pptx:1,pdf:1,txt:1,text:1},EXT_VIDEO_TYPES={swf:1,dat:1,mov:1,mp4:1,'3gp':1,avi:1,wma:1,rmvb:1,wmf:1,mpg:1,rm:1,asf:1,mpeg:1,mkv:1,wmv:1,flv:1,f4a:1,webm:1},EXT_COMPRESS_TYPES={zip:1,'7z':1,rar:1},EXT_REX=/\.([^\.]+)$/,NAME_NO_EXT_RE=new RegExp('(.+)(\\.(\\w+))$'),file_type_map=require('./file.file_type_map'),empty_str='',math=Math,parse_int=parseInt,undefined;var File=function(props){var me=this;if(!props.id){console.warn('new File(props) 无效的参数 id');return;}
me._id=props.id;me._is_dir=!!props.is_dir;me.set_name(props.name);me.set_size(props.size||0);me.set_cur_size(props.cur_size||0);me.set_create_time(props.create_time);me.set_modify_time(props.modify_time);me.set_file_ver(props.file_ver);me.set_file_md5(props.file_md5);me.set_file_sha(props.file_sha);me._pid=props.pid;me._is_dirty=props.is_dirty===true;me._is_downable=props.is_downable!==false;me._is_sortable=props.is_sortable!==false;me._is_movable=props.is_movable!==false;me._is_removable=props.is_removable!==false;me._is_renamable=props.is_renamable!==false;me._is_selectable=props.is_selectable!==false;me._is_droppable=me.is_dir()&&props.is_droppable!==false;me._icon=props.icon||'';me._whole_click=props.whole_click===true;me._is_tempcreate=props.is_tempcreate&&me.is_dir();if(me.is_broken_file()){me._is_movable=false;me._is_downable=false;}};File.prototype={_is_file_instance:true,is_image:function(){return this._is_image;},is_compress_file:function(){return this._is_compress_file;},is_preview_doc:function(){return this._is_preview_doc;},is_video:function(){return this._is_video;},is_broken_file:function(){return this._is_broken;},is_empty_file:function(){return this._is_empty;},is_dir:function(){return this._is_dir;},get_id:function(){return this._id;},get_type:function(){return this._type;},get_readability_size:function(){return this._readability_size;},get_name:function(){return this._name;},get_name_no_ext:function(){var n=this.get_name();if(this.is_dir()){return n;}else{var m=n.match(NAME_NO_EXT_RE);m=m?m[1]:n;return $.trim(m)||n;}},get_size:function(){return this._size;},get_cur_size:function(){return this._cur_size;},get_create_time:function(){return this._create_time||empty_str;},get_modify_time:function(){return this._modify_time||empty_str;},get_file_ver:function(){return this._file_ver;},get_file_md5:function(){return this._file_md5;},get_file_sha:function(){return this._file_sha;},set_name:function(name){this._name=name;this._type=File.get_type(this._name,this._is_dir);if(this._type in EXT_IMAGE_TYPES){this._is_image=true;}
else if(this._type in EXT_PREVIEW_DOC_TYPES){this._is_preview_doc=true;}
else if(this._type in EXT_VIDEO_TYPES){this._is_video=true;}
else if(this._type in EXT_COMPRESS_TYPES){this._is_compress_file=true;}},set_size:function(size){this._size=parse_int(size);},set_cur_size:function(cur_size){this._cur_size=parse_int(cur_size)||0;this._is_empty=!this._is_dir&&!this._cur_size;this._is_broken=!this._is_dir&&this._cur_size<this._size;this._readability_size=File.get_readability_size(this._size,this._is_dir);},set_create_time:function(create_time){this._create_time=create_time;},set_modify_time:function(modify_time){this._modify_time=modify_time;},set_file_ver:function(file_ver){this._file_ver=file_ver;},set_file_md5:function(file_md5){this._file_md5=file_md5;},set_file_sha:function(file_sha){this._file_sha=file_sha;},is_dirty:function(){return this._is_dirty;},is_removable:function(){return!this._is_tempcreate&&this._is_removable;},is_movable:function(){return!this._is_tempcreate&&this._is_movable;},is_downable:function(){return!this._is_tempcreate&&this._is_downable;},is_renamable:function(){return!this._is_tempcreate&&this._is_renamable;},is_sortable:function(){return!this._is_tempcreate&&this._is_sortable;},is_selectable:function(){return!this._is_tempcreate&&this._is_selectable;},is_droppable:function(){return!this._is_tempcreate&&this._is_droppable;},is_whole_click:function(){return this._whole_click;},is_tempcreate:function(){return this._is_tempcreate;},get_icon:function(){return this._icon;},get_pid:function(){return this._pid;}};File.get_type=function(name,is_dir){var ext;if(is_dir){return file_type_map.get_folder_type();}else{ext=!is_dir?File.get_ext(name):null;if(ext){return file_type_map.get_type_by_ext(ext);}}
return'';};File.get_ext=function(name){var m=(name||'').match(EXT_REX);return m?m[1].toLowerCase():null;};File.get_readability_size=function(bytes,is_dir){if(is_dir)
return'';bytes=parseInt(bytes);if(!bytes)
return'0B';var unit=parseInt(math.floor(math.log(bytes)/math.log(1024))),size=bytes/math.pow(1024,unit),decimal_size=(math.floor(size*100)/100);if(decimal_size!==parse_int(decimal_size)){size=decimal_size.toFixed(2);}
else{size=parse_int(size);}
return size+BYTE_UNITS[unit];};var re_name_deny=new RegExp('[\\:*?/\"<>|]'),max_len=255;File.check_name=function(name,is_dir){var err;if(!name){err='名不能为空，请重新命名';}
else if(re_name_deny.test(name)){return'不能包含以下字符之一 /\\:?*\"><|';}
else if(text.byte_len(name)>max_len){err='名过长，请重新命名';}
return err?(is_dir?'文件夹':'文件')+err:undefined;};File.is_instance=function(obj){return obj&&obj._is_file_instance;};return File;});define.pack("./file.file_type_map",["./file.file_object"],function(require,exports,module){var File=require('./file.file_object');var defaults='file',folder_type='folder',type_map={doc:['doc','docx','wps','docm','dot','dotx','dotm'],xls:['xls','xlsx','xlsm','xltx','xltm','xlam','xlsb'],ppt:['ppt','pptx','pptm'],bmp:['bmp','tiff','exif','raw'],'3gp':['3gp','3g2','3gp2','3gpp'],mpe:['mpe','mpeg','mpg','mpeg4'],asf:['asf','ram','m1v','m2v','mpe','mpeg','mpg','m4b','m4p','m4v','vob','divx','mkv','ogm','webm','ass','srt','ssa'],wav:['wav','midi','flac','ram','ra','mid','aac','m4a','ape','au','ogg'],c:['c','cpp','h','cs','plist'],'7z':['7z','z','7-zip'],ace:['ace','lzh','arj','gzip','bz2'],jpg:['jpg','jpeg'],rmvb:['rmvb','rm'],hlp:['hlp','cnt'],code:['ini','css','js','java','as','py','php'],exec:['exec','dll'],pdf:['pdf'],txt:['txt'],msg:['msg'],rp:['rp'],vsd:['vsd'],ai:['ai'],eps:['eps'],log:['log'],xmin:['xmin'],psd:['psd'],png:['png'],gif:['gif'],mod:['mod'],mov:['mov'],avi:['avi'],swf:['swf'],flv:['flv'],wmv:['wmv'],wma:['wma'],mp3:['mp3'],mp4:['mp4'],ipa:['ipa'],apk:['apk'],ipe:['ipe'],exe:['exe'],msi:['msi'],bat:['bat'],fla:['fla'],html:['html'],htm:['htm'],asp:['asp'],xml:['xml'],chm:['chm'],rar:['rar'],zip:['zip'],tar:['tar'],cab:['cab'],uue:['uue'],jar:['jar'],iso:['iso'],dmg:['dmg'],bak:['bak'],tmp:['tmp'],old:['old'],document:['document'],image:['image'],video:['video'],audio:['audio'],compress:['compress'],unknow:['unknow'],filebroken:['filebroken']},all_map={};for(var type in type_map){var sub_types=type_map[type];for(var i=0,l=sub_types.length;i<l;i++){all_map[sub_types[i]]=type;}}
var getWords=function(str,num){try{var index=0;for(var i=0,l=str.length;i<l;i++){if((/[^\x00-\xFF]/).test(str.charAt(i))){index+=2;}else{index++;}
if(index>num){return(str.substr(0,i)+'..');}}
return str;}catch(e){return str;}};return{get_type_by_ext:function(type){return all_map[type]||defaults;},get_folder_type:function(){return folder_type;},revise_file_name:function(file_name,type){switch(type){case 1:return file_name.length>24?[file_name.substring(0,8),'...',file_name.substring(file_name.length-13)].join(''):file_name;case 2:return file_name.length>17?[file_name.substring(0,7),'...',file_name.substring(file_name.length-7)].join(''):file_name;}}};});define.pack("./file.parse_file",["lib","./file.file_object"],function(require,exports,module){var lib=require('lib'),collections=lib.get('./collections'),File=require('./file.file_object'),empty=[],parse_int=parseInt,undefined;return{parse_file_attr:function(obj){var
is_dir=!!obj['dir_attr'],attr=obj[is_dir?'dir_attr':'file_attr'],id=obj[is_dir?'dir_key':'file_id'],name=attr[is_dir?'dir_name':'file_name'],create_time=obj[is_dir?'dir_ctime':'file_ctime'],modify_time=is_dir?obj['dir_mtime']:attr['file_mtime'],size=is_dir?0:parse_int(obj['file_size'])||0,cur_size=is_dir?0:parse_int(obj['file_cur_size'])||0,file_ver=is_dir?'':obj['file_ver']||'',file_md5=is_dir?'':obj['file_md5']||'',file_sha=is_dir?'':obj['file_sha']||'';return{is_dir:is_dir,id:id,name:name,create_time:create_time,modify_time:modify_time,size:size,cur_size:cur_size,file_ver:file_ver,file_md5:file_md5,file_sha:file_sha};},parse_file:function(obj){return obj&&new File(this.parse_file_attr(obj));},parse_files:function(objs){var me=this;if(objs&&objs.length){return collections.map(objs,function(obj){return new File(me.parse_file_attr(obj));});}else{return empty;}}}});define.pack("./filter.session_filter",["./query_user","./global.global_event"],function(require,exports,module){var query_user=require('./query_user');return function(caller,args,callback){if(!query_user.check_cookie()){require('./global.global_event').namespace('session').trigger('session_timeout');return;}
if(callback){return callback.apply(caller||window,args);}};});define.pack("./global.global_event",["lib","$"],function(require,exports,module){var lib=require('lib'),$=require('$'),events=lib.get('./events');var cache={},event,namespace=function(key){return cache[key]||(cache[key]=$.extend({},events));};event=$.extend({},events);event.namespace=namespace;module.exports=event;});define.pack("./global.global_function",["lib"],function(require,exports,module){var lib=require('lib'),console=lib.get('./console'),global=window,global_proxy={},stack={},call_counts={},call_history_map=global.__call_history_map||{};var
register=function(key,fn){var is_reg=key in stack,history=!is_reg?call_history_map[key]:null;if(history&&history.length){$.each(history,function(i,args){fn.apply(global,args);});delete call_history_map[key];}
return _register(key,fn);},_register=function(key,fn){if(!stack[key]){stack[key]=[];}
stack[key].push(fn);if(!global_proxy[key]||!global_proxy[key].__is_stack_caller){global[key]=global_proxy[key]=function(){var ret,ary=stack[key];for(var i=0,c;c=ary[i++];){ret=c.apply(global,arguments);if(ret===false){return false;}}
call_counts[key]++;return ret;};global_proxy[key].__is_stack_caller=true;call_counts[key]=0;}},get=function(key){return global_proxy[key];},get_called_count=function(key){return call_counts[key]||0;};return{register:register,get:get,get_called_count:get_called_count};});define.pack("./global.global_variable",[],function(require,exports,module){var
stack={},set=function(key,val){stack[key]=val;},get=function(key){return stack[key];},del=function(key){var val=stack[key];delete stack[key];return val;};return{get:get,set:set,del:del};});define.pack("./init.click_tj",["lib","common","$"],function(require,exports,module){try{var
lib=require('lib'),common=require('common'),$=require('$'),cookie=lib.get('./cookie'),store=lib.get('./store'),console=lib.get('./console'),user_log=common.get('./user_log'),constants=common.get('./constants'),log_event=common.get('./global.global_event').namespace('log'),sel_files_len=0,view_id=1,contextmenu_visible=false,ui_selected='.ui-selected',undefined;log_event.on('sel_files_len_change',function(len){if(typeof len!=='number'){console.error('sel_files_len_change 无效的参数');len=0;}
sel_files_len=len;user_log.set_base_param('extInt1',sel_files_len);});log_event.on('view_type_change',function(vid){view_id=vid;user_log.set_base_param('extInt2',view_id);});log_event.on('contextmenu_toggle',function(is_visible){if(typeof is_visible!=='boolean'){console.error('is_visible 无效的参数');is_visible=false;}
contextmenu_visible=is_visible?1:0;});$('body').off('mouseup.EvtTongji').on('mouseup.EvtTongji',function(evt){var which=evt.which;var $el=$(evt.target).closest('[data-tj-action]');if(which==1&&$el.length!=0){setTimeout(function(){user_log(parseInt($el.attr('data-tj-value')),0);},200);}else if(which==3&&contextmenu_visible){setTimeout(function(){user_log('RIGHTKEY_MENU',0);},200);}});}catch(e){console&&console.error(e.message);}});define.pack("./init.default_global_events",["$","lib","common"],function(require,exports,module){var
$=require('$'),lib=require('lib'),common=require('common'),events=lib.get('./events'),global_event=common.get('./global.global_event'),functional=common.get('./util.functional'),$win=$(window),$doc=$(document),WINDOW_RESIZE='window_resize',WINDOW_RESIZE_REAL_TIME='window_resize_real_time',WINDOW_SCROLL='window_scroll',PRESS_KEY_ESC='press_key_esc',PAGE_UNLOAD='page_unload',resize_timer,scroll_timer,win_width=$win.width(),win_height=$win.height(),undefined;$win.on('resize.default_events',function(){var w=$win.width(),h=$win.height();if(w===0||h===0){return;}
clearTimeout(resize_timer);resize_timer=setTimeout(function(){var new_width=$win.width(),new_height=$win.height();if(win_width!=new_width||win_height!=new_height){win_width=new_width;win_height=new_height;global_event.trigger(WINDOW_RESIZE,win_width,win_height);}},200);global_event.trigger(WINDOW_RESIZE_REAL_TIME,$win.width(),$win.height());}).on('scroll.default_events',function(){clearTimeout(scroll_timer);scroll_timer=setTimeout(function(){global_event.trigger(WINDOW_SCROLL);},200);}).one('unload.default_events',function(){global_event.trigger(PAGE_UNLOAD);});$doc.on(($.browser.msie&&$.browser.version<7)?'keypress.default_events':'keydown.default_events',function(e){if(e.which===27){global_event.trigger(PRESS_KEY_ESC);}});});define.pack("./init.download_check",["$","lib","common"],function(require,exports,module){var $=require('$'),lib=require('lib'),common=require('common'),user_log=common.get('./user_log'),image_loader=lib.get('./image_loader'),download_domain_arr=['xatfs.yun.ftn.qq.com','xa.yun.ftn.qq.com','njtfs.yun.ftn.qq.com','tjtfs.yun.ftn.qq.com','hz.yun.ftn.qq.com','sztfs.yun.ftn.qq.com','cd.yun.ftn.qq.com','sz.yun.ftn.qq.com','tj.yun.ftn.qq.com','sh.yun.ftn.qq.com','xg.yun.ftn.qq.com','xfxa.ctfs.ftn.qq.com','xfcd.ctfs.ftn.qq.com','cd.yunbatch.ftn.qq.com','hz.yunbatch.ftn.qq.com','sh.yunbatch.ftn.qq.com','sz.yunbatch.ftn.qq.com','tj.yunbatch.ftn.qq.com','xa.yunbatch.ftn.qq.com','xg.yunbatch.ftn.qq.com'],url_suffix='/ftn_handler/f9ab366bb9f7b5c9127ce8501a44bd5cb11ed85b25db28d70c101572d2f8014eca723af5fc0c937c7cc56afce01f123fadb619fad2e31be6ba621d639eb6f369/ea7df583983133b62712b5e73bffbcd45cc53736/?fname=bt.gif',cur_num=0,cur_data=[],on_img_load_callback=function(ok,domain){cur_data.push({op:405,rst:ok?0:1,service_id:1,subop:0,extString1:domain});cur_num++;if($.browser.msie&&$.browser.version<7){var mod=download_domain_arr.length/2;if(cur_num%mod==0){user_log.pitch_log(405,cur_data);}}
else{if(cur_num==download_domain_arr.length){user_log.pitch_log(405,cur_data);}}};setTimeout(function(){$.each(download_domain_arr,function(i,domain){image_loader.load('http://'+domain+url_suffix).done(function(){on_img_load_callback(true,domain);}).fail(function(){on_img_load_callback(false,domain);});});},10000);});define.pack("./init.enable_repaint",["$"],function(require,exports,module){var $=require("$");$.fn.extend({repaint:function(){var el=$(this);el.addClass("x-repaint");el.height();el.removeClass("x-repaint");}});});define.pack("./init.fix_ie6",["$"],function(require,exports,module){var $=require('$');if($.browser.msie&&$.browser.version<7){try{document.execCommand('BackgroundImageCache',false,true);}catch(e){}}});define.pack("./init.init",["./init.prevent_events","./init.prevent_error","./init.default_global_events","./init.fix_ie6","./init.click_tj","./init.enable_repaint"],function(require,exports,module){return function(){require('./init.prevent_events');require('./init.prevent_error');require('./init.default_global_events');require('./init.fix_ie6');require('./init.click_tj');require('./init.enable_repaint');};});define.pack("./init.prevent_error",["$","lib","./constants"],function(require,exports,module){var
$=require('$'),lib=require('lib'),console=lib.get('./console'),constants=require('./constants'),prevent_error=!constants.IS_DEBUG&&($.browser.msie||constants.IS_APPBOX),undefined;window.onerror=function(msg,file,line){console.error(msg,file||'',line||'');return prevent_error;};});define.pack("./init.prevent_events",["lib","common","$"],function(require,exports,module){var
lib=require('lib'),common=require('common'),$=require('$'),console=lib.get('./console'),constants=common.get('./constants'),doc=document,$body=$(doc.body),INPUTS='input, textarea',undefined;if(constants.IS_APPBOX){var
PREVENT_CTRL_KEYS={65:0,70:0,78:0,80:0,82:0},PREVENT_KEYS={116:0},K_BACKSPACE=8;$body.on({keydown:function(e){var k=e.which;if(k in PREVENT_KEYS||(e.ctrlKey&&(k in PREVENT_CTRL_KEYS))||k===K_BACKSPACE&&!(e.target&&e.target.tagName.toUpperCase()==='INPUT')){e.preventDefault();}}});}
$body.on('dragstart',function(e){if($(e.target).closest('.ui-draggable').length===0){e.preventDefault();}});$(doc).on('contextmenu.file_list_context_menu',function(e){var $target=$(e.target);if(!$target.is(INPUTS)){e.preventDefault();}});});define.pack("./m_speed",["lib","common"],function(require,exports,module){var
lib=require('lib'),common=require('common'),configs={},action_times={},log_images={},log_image_id_seq=0,console=lib.get('./console').namespace('m_speed');var speed={__enable:Math.random()<100/100,config:function(cfg){configs=cfg;},start:function(mod_name,action_name){var action=this._get_action(mod_name,action_name);if(!action._done&&!action._start){action._start=new Date();}},done:function(mod_name,action_name){var action=this._get_action(mod_name,action_name);if(action._start&&!action._done){action._done=new Date();}},time:function(mod_name,action_name){var action=this._get_action(mod_name,action_name);if(action._done&&action._start){return action._done.getTime()-action._start.getTime();}
return'';},set:function(mod_name,action_name,start_date,done_date){var action=this._get_action(mod_name,action_name);action._start=start_date;action._done=done_date;},send:function(mod_name,action_name,time){if(!this.__enable){return;}
var mod=configs[mod_name];var times={},time_arr=[];var index;if(action_name){index=mod[action_name];time=time||this.time(mod_name,action_name);times[index]=time;time_arr.push(index+'('+action_name+')'+'='+time);if(mod_name in action_times){delete action_times[mod_name][action_name];}}else{for(var action in mod){if(action.indexOf('_')!==0){index=mod[action];time=this.time(mod_name,action);times[index]=time;time_arr.push(index+'('+action+')'+'='+time);}}
delete action_times[mod_name];}
if(console){}
this._send(mod.__flags,times);},send_one:function(flags,index,time){var times={};times[index]=time;this._send(flags,times);},_send:function(flags,index_map_time){if(!index_map_time)return;var times_arr=[];for(var index in index_map_time){var time=index_map_time[index];if(time){times_arr.push(index+'='+time);}}
if(!times_arr.length)return;var flags_arr=flags.split('-'),args=['flag1='+flags_arr[0],'flag2='+flags_arr[1],'flag3='+flags_arr[2]].concat(times_arr);var uin=common.get('./query_user').get_uin_num();if(uin){args.push('uin='+uin);}
var id=log_image_id_seq++,img=log_images[id]=new Image();img.onload=img.onerror=img.onabort=function(){this.onload=this.onerror=this.onabort=null;delete log_images[id];};img.src='http://isdspeed.qq.com/cgi-bin/r.cgi?'+args.join('&');},_get_action:function(mod_name,action_name){var mod=action_times[mod_name]||(action_times[mod_name]={});return mod[action_name]||(mod[action_name]={});}};return speed;});define.pack("./module",["lib","common","$"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),collections=lib.get('./collections'),console=lib.get('./console').namespace('module'),events=lib.get('./events'),global_event=common.get('./global.global_event'),defaults={ui:null,render:$.noop},empty=[],instances=[],undefined;var Module=function(module_name,options){if(typeof module_name!=='string'){throw'module.js:无效的module_name参数';}
instances.push(this);options&&$.extend(this,defaults,options);this.module_name=module_name;this.__rendered=this.__activated=this.__deactivated=false;var org_render=this.render;this.render=function(){if(this.__rendered)
return;var render_ui=true;if(typeof org_render==='function'){var render_ret=org_render.apply(this,arguments);if(render_ret===false){render_ui=false;}}
if(render_ui&&this.ui){if(!Module.is_instance(this.ui)){throw module_name+'的UI模块必须是Module实例';}
this.ui.render.apply(this.ui,arguments);}
this.__rendered=true;this.trigger('render');global_event.trigger(this.module_name+'_render',this);};var org_activate=this.activate;this.activate=function(params){if(this.__activated||!this.__rendered)
return;this.__deactivated=false;this.__activated=true;if(typeof org_activate==='function'){org_activate.call(this,params);}
if(this.ui&&Module.is_instance(this.ui)){this.ui.activate(params);}
this.trigger('activate',params);var sub_modules=this.get__sub_modules();if(sub_modules.length){$.each(sub_modules,function(i,mod){mod.activate(params);});}};var org_deactivate=this.deactivate;this.deactivate=function(){if(this.__deactivated||!this.__rendered)
return;this.__activated=false;this.__deactivated=true;if(typeof org_deactivate==='function'){org_deactivate.apply(this);}
if(this.ui&&Module.is_instance(this.ui)){this.ui.deactivate();}
this.trigger('deactivate');var sub_modules=this.get__sub_modules();if(sub_modules.length){$.each(sub_modules,function(i,mod){mod.deactivate();});}};};$.extend(Module.prototype,events,{__is_module:true,add_sub_module:function(mod){if(!Module.is_instance(mod)){throw'Module#add_sub_module(mod) -> mod 必须是一个 Module 实例';}
this.__sub_modules||(this.__sub_modules=[]);this.__sub_modules.push(mod);},get__sub_modules:function(){return this.__sub_modules||empty;},is_rendered:function(){return this.__rendered;},is_activated:function(){return this.__activated;},is_deactivated:function(){return this.__deactivated;}});Module.is_instance=function(obj){return obj&&obj.__is_module;};return Module;});define.pack("./query_user",["lib","common","$"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),console=lib.get('./console'),cookie=lib.get('./cookie'),events=lib.get('./events'),cur_url=lib.get('./url_parser').get_cur_url(),constants=common.get('./constants'),request=common.get('./request'),local_uin,cached_user,loading_request,switching_user,ok_stack=[],fail_stack=[],Math=window.Math,undefined;var query_user={get:function(force,cavil,reset_tip_status,silent_callback){var me=this,silent=$.isFunction(silent_callback);reset_tip_status=reset_tip_status===true;if(!force&&cached_user){setTimeout(function(){me._ok_callback(cached_user);},20);}
else{if(loading_request&&this.get_switching_user()){loading_request.destroy();}
else if(loading_request){return this;}
loading_request=request.get({cmd:'query_user',cavil:cavil,body:reset_tip_status?{show_migrate_fav:1,show_qqdisk_firstaccess_flag:1}:undefined}).ok(function(msg,body,header){cached_user=new User(header.uin,body);if(!local_uin){local_uin=cached_user.get_uin();}
if(silent){silent_callback.call(me,cached_user);}else{me._ok_callback.call(me,cached_user);query_user.trigger('load',cached_user);}}).fail(function(msg,ret){if(!silent){me._fail_callback.apply(me,arguments);query_user.trigger('error',msg,ret);}}).done(function(msg,ret){loading_request=false;if(!silent){query_user.trigger('done',msg,ret);}})}
return this;},check:function(){var def=$.Deferred();request.get({cmd:'query_user',cavil:true}).ok(function(){def.resolve();}).fail(function(){def.reject();});return def;},ok:function(fn){if($.inArray(fn,ok_stack)===-1){ok_stack.push(fn);}
return this;},fail:function(fn){if($.inArray(fn,fail_stack)===-1){fail_stack.push(fn);}
return this;},_ok_callback:function(){var me=this;if(ok_stack.length){$.each(ok_stack,function(i,fn){fn.call(me,cached_user);});ok_stack=[];}},_fail_callback:function(){var me=this,args=$.makeArray(arguments);if(fail_stack.length){$.each(fail_stack,function(i,fn){fn.apply(me,args);});fail_stack=[];}},set_switching_user:function(done){switching_user=true;},get_switching_user:function(){return switching_user;}};$.extend(query_user,events);query_user.get_uin=function(){return cookie.get('uin')||cookie.get('clientuin');};query_user.get_skey=function(){return cookie.get('skey');};query_user.get_client_skey=function(){console.warn('query_user.get_client_skey() 尚未验证');return cur_url.get_param('clientuin');};query_user.get_uin_num=function(){return parseInt(this.get_uin().replace(/^[oO0]*/,''))||'';};query_user.destroy=function(){var cookie_options={domain:constants.MAIN_DOMAIN,path:'/'};$.each(['skey','indep','uin','clientuin'],function(i,key){cookie.unset(key,cookie_options);});return true;};query_user.check_cookie=function(){return!!(this.get_uin()&&this.get_skey());};query_user.get_cached_user=function(){return cached_user;};query_user.get_local_uin=function(){return local_uin;};if(typeof query_user.get_uin_num()!=='number'){query_user.destroy();}
var User=function(uin,data){this._uin=uin;this._d=data;};User.prototype={get_uin:function(){return this._uin;},get_skey:function(){return query_user.get_skey()},has_pwd:function(){return this._d['isset_passwd']===1;},set_has_pwd:function(has){this._d['isset_passwd']=has?1:0;},get_files_download_count_limit:function(){return this._get_int('MaxBatchDownloadFileCnt',10);},get_files_remove_step_size:function(){return Math.min(this._get_int('MaxBatchDeleteFileCnt'),this._get_int('MaxBatchDeleteFolderCnt'),10);},get_files_move_step_size:function(){return Math.min(this._get_int('MaxBatchMoveFileCnt'),this._get_int('MaxBatchMoveFolderCnt'),10);},get_rec_restore_step_size:function(){return Math.min(this._get_int('MaxBatchRestoreFileCnt'),this._get_int('MaxBatchRestoreFolderCnt'),10);},get_MaxFileAndFolderCnt:function(){return this._get_int('MaxFileAndFolderCnt',65534);},get_dir_count:function(){return this._d['dir_count']},get_dir_level_max:function(){return this._d['dir_level_max']},get_file_count:function(){return this._d['file_count']},get_filename_max_len:function(){return this._get_int('filename_max_len');},get_filepath_max_len:function(){return this._get_int('filepath_max_len');},get_get_timestamp_interval:function(){return this._d['get_timestamp_interval']},get_getlist_timestamp_flag:function(){return this._d['getlist_timestamp_flag']},get_root_key:function(){return this._d['root_key']},get_main_key:function(){return this._d['main_key']},get_main_dir_key:function(){return this._d['main_dir_key']},get_main_dir_name:function(){return this._d['main_dir_name']},get_max_batch_dirs:function(){return this._d['max_batch_dirs']},get_max_cur_dir_file:function(){return this._d['max_cur_dir_file']},get_max_dir_file:function(){return this._d['max_dir_file']},get_max_dl_tasks:function(){return this._d['max_dl_tasks']},get_max_dts:function(){return this._d['max_dts']},get_max_fz:function(){return this._d['max_fz']},get_max_indexs_per_dir:function(){return this._d['max_indexs_per_dir']},get_max_interval_getlist:function(){return this._d['max_interval_getlist']},get_max_note_len:function(){return this._get_int('max_note_len');},get_max_retry:function(){return this._d['max_retry']},get_max_retry_interval:function(){return this._d['max_retry_interval']},get_max_single_file_size:function(){return this._d['max_single_file_size']},get_max_tasks:function(){return this._d['max_tasks']},get_max_thread_getlist:function(){return this._d['max_thread_getlist']},get_max_ul_tasks:function(){return this._d['max_ul_tasks']},get_pic_key:function(){return this._d['pic_key']},get_qdisk_psw:function(){return this._d['qdisk_psw']},get_stat_flag:function(){return this._d['stat_flag']},get_stat_interval:function(){return this._d['stat_interval']},get_total_space:function(){return parseInt(this._d['total_space']);},get_used_space:function(){return this._get_int('used_space');},get_user_authed:function(){return this._d['user_authed']},get_user_ctime:function(){return this._d['user_ctime']},get_user_mtime:function(){return this._d['user_mtime']},get_user_type:function(){return this._d['user_type']},get_user_wright:function(){return this._d['user_wright']},get_vip_level:function(){return this._d['vip_level']},get_nickname:function(){return this._d['nickname'];},is_qqdisk_user:function(){return this._d['qqdisk_user_flag']==1;},is_qqdisk_user_first_access:function(){return this._d['qqdisk_firstaccess_flag']==1;},has_qqdisk_pwd:function(){return this._d['isset_pwd_qqdisk']==1;},is_favorites_user:function(){return!!this._d['IsFavoritesUser'];},is_fav_user_first_access:function(){return this._d['MigrateFavorites']==1;},is_wy_mobile_user:function(){return this._d['weiyun_mobile']==1;},is_weixin_user:function(){return this._d['weixin_collect_flag']==1;},_get_int:function(key,defaults){return parseInt(this._d[key])||defaults||0;}};return query_user;});define.pack("./request",["lib","$","./constants","./ret_msgs","./urls","./global.global_event","./cgi_ret_report","./m_speed","./tmpl","./configs.ops","./user_log","./query_user"],function(require,exports,module){var lib=require('lib'),$=require('$'),console=lib.get('./console').namespace('request'),text=lib.get('./text'),events=lib.get('./events'),security=lib.get('./security'),JSON=lib.get('./json'),random=lib.get('./random'),collections=lib.get('./collections'),url_parser=lib.get('./url_parser'),constants=require('./constants'),ret_msgs=require('./ret_msgs'),urls=require('./urls'),session_event=require('./global.global_event').namespace('session'),cgi_ret_report=require('./cgi_ret_report'),m_speed=require('./m_speed'),tmpl=require('./tmpl'),ops=require('./configs.ops'),user_log,root=window,error_status={error:'网络错误, 请稍后再试',timeout:'连接服务器超时, 请稍后再试',parsererror:'服务器出现错误, 请稍后再试'},unknown_code=ret_msgs.UNKNOWN_CODE,unknown_msg=ret_msgs.UNKNOWN_MSG,main_v=constants.IS_APPBOX?12:11,os_type=constants.APPID,default_body={},default_header={cmd:'',main_v:main_v,proto_ver:10006,sub_v:1,encrypt:0,msg_seq:1,source:os_type,appid:os_type,client_ip:'127.0.0.1',token:''},default_options={url:'',cmd:'',just_plain_url:false,body:null,header:null,cavil:false,resend:false,re_try:2,re_try_flag:false},triggered_on_switch=false,callback_timeout=10,set_timeout=setTimeout,D=Date,undefined;var request={get:function(options){return this._new_request(JsonpRequest,arguments);},post:function(options){return this._new_request(IframePostRequest,arguments);},_new_request:function(RequestClass,args_){var options;if(args_&&typeof args_[0]==='object'){options=args_[0];}
else{throw'request.get / .post 无效的请求参数';}
return new RequestClass(options);}};var AbstractRequest=function(options){this._options=$.extend({},default_options,options,{ok_fn:[],fail_fn:[],done_fn:[]});};AbstractRequest.prototype={_default_url:null,_def_error_data:{rsp_header:{ret:404,msg:'连接服务器超时，请稍后再试'},rsp_body:{}},_send:null,destroy:null,ok:function(fn){this._options.ok_fn.push(fn);return this;},fail:function(fn){this._options.fail_fn.push(fn);return this;},done:function(fn){this._options.done_fn.push(fn);return this;},_get_data:function(){var o=this._options,header=$.isFunction(o.header)?o.header():o.header,body=$.isFunction(o.body)?o.body():o.body,data={req_header:$.extend({},default_header,header,{cmd:o.cmd,token:security.getAntiCSRFToken()}),req_body:$.extend({},default_body,body)};return data;},_get_cgi_url:function(data,params){var me=this,o=me._options,cmd=data.req_header.cmd,cgi_url;var special_url=url_parser.parse(o.url||me._default_url);cgi_url=urls.make_url(special_url.get_url(),$.extend({cmd:cmd},special_url.get_params(),params));return cgi_url;},_log_rey_succ:function(){if(this._options.re_try_flag===true){user_log=user_log||require('./user_log');user_log('re_try_flag',0,{extString1:this._options.cmd});}},_callback:function(data,is_timeout){var end_time=new Date().getTime();var me=this;this._clear_timeout();if(!data.rsp_body)
data.rsp_body={};if(!data.rsp_header)
data.rsp_header={};var
url=me._options.url||me._default_url,cmd=me._options.cmd,header=data.rsp_header,body=data.rsp_body,ret=(typeof header.ret==='number'?header.ret:data.ret)||0,msg=header.msg||ret_msgs.get(ret),cavil=me._options.cavil,resend=me._options.resend;if(ret===0){$.each(me._options.ok_fn,function(i,fn){if($.isFunction(fn)){me._log_rey_succ();fn.call(me,msg,body,header,data);}});}else{var is_sess_timeout=ret_msgs.is_sess_timeout(ret),is_indep_invalid=ret_msgs.is_indep_invalid(ret);if(cavil&&is_sess_timeout||is_indep_invalid){msg='';}
$.each(me._options.fail_fn,function(i,fn){if($.isFunction(fn)){fn.call(me,msg,ret,body,header,data);}});if(cavil&&is_sess_timeout){session_event.trigger('session_timeout',resend?function(){me._options.resend=false;me._send();}:null);}
else{if(cavil&&is_indep_invalid){session_event.trigger('invalid_indep_pwd',resend?function(){me._options.resend=false;me._send();}:null,body);}}}
$.each(me._options.done_fn,function(i,fn){if($.isFunction(fn)){fn.call(me,msg,ret,body,header,data);}});me.destroy();set_timeout(function(){reporter.all(url,cmd,ret,end_time-me.__start_time,is_timeout);},0);},_before_start:function(){if(!triggered_on_switch){var query_user=require('./query_user'),local_uin=query_user.get_local_uin();if(local_uin&&local_uin!==query_user.get_uin_num()){triggered_on_switch=true;query_user.set_switching_user(true);session_event.trigger('session_timeout',function(){window.onbeforeunload=null;window.location.reload();});return false;}}},_timeout:function(){this.destroy();if(this._options.re_try-->0){this._options.re_try_flag=true;return this._send();}
this._callback(this._def_error_data,true);},_start_timeout:function(){var me=this;me.__timer=set_timeout(function(){me._timeout();},callback_timeout*1000);},_clear_timeout:function(){clearTimeout(this.__timer);}};var JsonpRequest=function(options){AbstractRequest.apply(this,arguments);this._send();};$.extend(JsonpRequest.prototype,AbstractRequest.prototype,{_default_url:'http://web.cgi.weiyun.com/wy_web_jsonp.fcg',_send:function(){var me=this,o=me._options;if(me._before_start&&me._before_start()===false){return false;}
var data=me._get_data(),cgi_url=me._get_cgi_url(data),callback_name='get_'+_rand();this.__start_time=new D().getTime();var jqXHR=me._req=$.ajax({url:cgi_url,dataType:'jsonp',cache:false,jsonpCallback:callback_name,data:o.just_plain_url?undefined:{data:JSON.stringify(data)}});me._start_timeout();jqXHR.success(function(data){if(o.adaptDate){data=o.adaptDate(data);}
set_timeout(function(){me._callback(data,false);},0);}).error(function(jqXHR,status){if(status!=='abort'){console.error('request error:',status);me._callback({rsp_header:{ret:unknown_code,msg:error_status[status]||unknown_msg},rsp_body:{}},false);}});return jqXHR;},destroy:function(){this._clear_timeout();if(this._req){this._req.abort();this._req=null;}}});var IframePostRequest=function(options){AbstractRequest.apply(this,arguments);this._send();};IframePostRequest._iframe_pool=[];IframePostRequest._iframe_pool_limit=5;IframePostRequest._get_$container=function(){return this._$div||(this._$div=$('<div data-id="post_iframe_cont" style="display:none;"></div>').appendTo(document.body))};$.extend(IframePostRequest.prototype,AbstractRequest.prototype,{_default_url:'http://web.cgi.weiyun.com/wy_web_jsonp.fcg',_send:function(){var me=this;if(me._before_start&&me._before_start()===false){return false;}
var data=me._get_data(),callback=me._callback_name='post_callback_'+_rand(),cgi_url=me._get_cgi_url(data,{callback:callback}),$form=this._get_form(data,callback);root[callback]=function(data){set_timeout(function(){me._callback(data,false);},0);};me._start_timeout();this._get_iframe(function($iframe){me._$iframe=$iframe;me.__start_time=new D().getTime();$iframe.attr('data-action',cgi_url);$form.attr('action',cgi_url).attr('target',$iframe.attr('name')).submit();});return this;},_get_form:function(data,callback){var $form=this._$form=$('<form style="display:none;" method="POST"></form>').appendTo(IframePostRequest._get_$container());if(!this._options.just_plain_url){var str_data=JSON.stringify(data);$('<input type="hidden"/>').attr('name','data').val(str_data).appendTo($form);$('<input type="hidden"/>').attr('name','callback').val(callback).appendTo($form);}
return $form;},_get_iframe:function(_callback){var me=this,free_iframes=IframePostRequest._iframe_pool,$iframe=free_iframes.shift(),callback=function($iframe){_callback($iframe);};if($iframe){$iframe.data('released',false);callback($iframe);}
else{$iframe=$("<iframe src=\""+constants.DOMAIN+"/set_domain.html\" name=\""+_rand()+"\" style=\"display:none;\"></iframe>");$iframe.one('load',function(){$iframe.on('load',function(){me._release_iframe($iframe);});callback($iframe);});$iframe.appendTo(IframePostRequest._get_$container());}},_release_iframe:function($iframe){set_timeout(function(){var free_iframes=IframePostRequest._iframe_pool;if(free_iframes.length<IframePostRequest._iframe_pool_limit){if($iframe.data('released')===false){try{var iframe_win=$iframe[0].contentWindow;if($.browser.msie){iframe_win.document.execCommand('Stop');}else{iframe_win.stop();}
var script=iframe_win.document.getElementsByTagName('script')[0];if(script){script.parentNode.removeChild(script);}}catch(e){}
$iframe.data('released',true);}
if($.inArray($iframe,free_iframes)==-1){free_iframes.push($iframe);}}
else{$iframe.remove();}},0);},destroy:function(){this._clear_timeout();if(this._callback_name){window[this._callback_name]=$.noop;}
if(this._$iframe){this._release_iframe(this._$iframe);this._$iframe=null;}
if(this._$form){this._$form.remove();this._$form=null;}
if(this._$div){this._$div.remove();this._$div=null;}}});var reporter={all:function(url,cmd,ret,time,is_timeout){if(!is_timeout){this.m_speed_report(cmd,time);}
this.oz_op_report(cmd,ret);this.ret_report(url,cmd,ret,time);},m_speed_report:function(cmd,time){try{var m_speed_flags=ops.get_m_speed_flags(cmd);if(m_speed_flags){var m_speed_flags_arr=m_speed_flags.split('-');var flags=m_speed_flags_arr.splice(0,3).join('-');var index=m_speed_flags_arr.pop();m_speed.send_one(flags,index,time);}}
catch(e){}},oz_op_report:function(cmd,ret){var op=ops.get_oz_op(cmd);if(op){user_log||(user_log=require('./user_log'));user_log(op,ret);}},ret_report:function(url,cmd,ret,time){cgi_ret_report.report(url,cmd,ret,time);}};var _rand=function(){return'R'+random.random();};return request;});define.pack("./request_task",["lib","$","./ret_msgs","./user_log","./request","./configs.ops","./m_speed"],function(require,exports,module){var lib=require('lib'),$=require('$'),collections=lib.get('./collections'),console=lib.get('./console'),events=lib.get('./events'),ret_msgs=require('./ret_msgs'),user_log=require('./user_log'),request=require('./request'),ops=require('./configs.ops'),m_speed=require('./m_speed'),D=Date,undefined;var RequestTask=function(options){var me=this;this.options=options;me._todo_files=options.files.slice();me._step_size=options.step_size;me._org_len=options.files.length;me._ok_rets=options.ok_rets instanceof Array?collections.array_to_set(options.ok_rets):[0];me._results={};me._step_index=0;me._speed_logs={};me.on('step',function(do_len,org_len,step_index){try{me._speed_logs[step_index]={start:new D().getTime()};}catch(e){}}).on('step_ok',function(len,step_index,cmd){try{var m_speed_flags=ops.get_m_speed_flags(cmd);if(m_speed_flags){var step_time=new D().getTime()-me._speed_logs[step_index].start;var avg=step_time/len;m_speed_flags=m_speed_flags.split('-');var flags=m_speed_flags.splice(0,3).join('-');var index=m_speed_flags.pop();m_speed.send_one(flags,index,avg);}}catch(e){}})};RequestTask.prototype={start:function(){var todo_files=this._todo_files;if(todo_files&&todo_files.length){this.trigger('start');this._step();}
return this;},_step:function(){var
me=this,step_size=me._step_size,todo_files=me._todo_files,todo_len=me._todo_files.length,org_len=me._org_len,frag_files=collections.sub(todo_files,function(it,i){return 0==i||(i<step_size&&it.is_dir()==todo_files[i-1].is_dir());});if(frag_files.length){if(org_len==todo_files.length){console.error('RequestTask 出现异常：collections.sub() 未成功剔除元素');me._process_done();return;}
me._step_index++;me.trigger('step',org_len-todo_len+1,org_len,me._step_index);var cmd=me._get_cmd(frag_files),data=me._get_data(frag_files);request.post({cmd:cmd,body:data,cavil:true}).ok(function(msg,body){if(body.results){me.trigger('step_ok',body.results.length,me._step_index,cmd);var results=body.results;$.each(frag_files,function(i,it){me._results[it.get_id()]=results?parseInt(results[i].result):ret_msgs.UNKNOWN_CODE;});}}).fail(function(msg,ret){$.each(frag_files,function(i,it){me._results[it.get_id()]=ret;});}).done(function(msg,ret){me.trigger('step_done',ret);if(!todo_files.length){me._process_done();}else{me._step();}});}},_get_cmd:function(frag_files){return this.options.cmd_parser(frag_files);},_get_data:function(frag_files){return this.options.data_parser(frag_files);},_process_done:function(){var ok_rets=this._ok_rets,first_err_ret=0,has_ok=false,ok_count=0,ok_ids={},ok_id_arr=[],todo_files=this._todo_files;$.each(this._results,function(id,ret){var this_is_ok=(ret in ok_rets);if(!first_err_ret&&!this_is_ok){first_err_ret=ret;}
else if(this_is_ok){has_ok=true;ok_ids[id]=null;ok_id_arr.push(id);ok_count++;}});if(has_ok){collections.remove(todo_files,function(file){return file.get_id()in ok_ids;});todo_files.length?console.log('剩余未成功',todo_files.length):console.log('批量处理完成');}
var all_ok=first_err_ret==0,msg=ret_msgs.get(first_err_ret);log(this.options.op,first_err_ret);if(all_ok){this.trigger('all_ok',msg,ok_id_arr);}
else if(has_ok&&!all_ok){this.trigger('part_ok',msg,ok_id_arr);}
else if(!has_ok&&!all_ok){this.trigger('error',msg);}
if(has_ok){this.trigger('has_ok',ok_id_arr,first_err_ret,msg);}
this.trigger('done',first_err_ret);this.destroy();},destroy:function(){this.off().stopListening();}};var log=function(op,ret){if(op){if(typeof op==='string'){op=ops.get_oz_op_by_name(op);}else if(op==='number'){}else{op=null;}
if(op){user_log(op,ret);}}else{console.error('未指定有效的 op 参数');}};$.extend(RequestTask.prototype,events);return RequestTask;});define.pack("./ret_msgs",[],function(require,exports,module){var
MAP={0:'操作成功',404:'连接服务器超时，请稍后再试',1000:'出现未知错误',1008:'无效的请求命令字',1010:false,1012:'系统正在初始化，请稍后再试',1013:'存储系统繁忙，请稍后再试',1014:'服务器繁忙，请稍后再试',1015:'创建用户失败',1016:'不存在该用户',1017:'无效的请求格式',1018:false,1019:'目录不存在',1020:'文件不存在',1021:'目录已经存在',1022:'文件已经存在',1023:'上传地址获取失败',1024:'登录状态超时，请重新登录',1025:'存储系统繁忙，请稍后再试',1026:'父目录不存在',1027:'无效的目录信息',1028:'目录或文件数超过总限制',1029:'单个文件大小超限',1030:'签名已经超时，请重新验证独立密码',1031:'验证独立密码失败',1032:'设置独立密码失败',1033:'删除独立密码失败',1034:'失败次数过多，独立密码被锁，请稍后再试',1035:'独立密码不能与QQ密码相同',1051:'该目录下已经存在同名文件',1052:'该文件未完整上传，无法下载',1053:'剩余空间不足',1070:'不能分享超过2G的文件',1076:'根据相关法律法规和政策，该文件禁止分享',1083:'该目录下文件个数已达上限，请清理后再试',1086:'网盘文件个数已达上限，请清理后再试',1088:'无效的文件名',1117:'部分文件或目录不存在，请刷新后再试',3002:'不能对不完整的文件进行该操作',3008:'不能对空文件进行该操作',4000:'登录状态超时，请重新登录',10000:'登录状态超时，请重新登录',10408:'该文件已加密，无法下载',100001:'参数无效',100002:'无效的请求格式',100003:'请求中缺少协议头',100004:'请求中缺少协议体',100005:'请求中缺少字段',100006:'无效的命令',100007:'导入数据请求无效',100008:'目录的ID长度无效',100009:'文件的SHA值长度无效',100010:'文件的MD5值长度无效',100011:'文件的ID长度无效',100012:'返回数据过长导致内存不足',100016:'指针无效',100017:'时间格式无效',100019:'输入字段类型无效',100027:'无效的文件名',100028:'文件已过期',100029:'文件超过下载次数限制',100030:'收听官方微博失败',100031:'用户未开通微博',100033:'分享到微博失败',100034:'内容中出现脏字、敏感信息',100035:'用户限制禁止访问',100036:'内容超限',100037:'帐号异常',100038:'请休息一下吧',100039:'请勿重复发表微博',100040:'身份验证失败',114200:'文件已被删除',114201:'文件已损坏',190051:'登录状态超时，请重新登录',190054:'访问超过频率限制',190055:'服务器暂时不可用，请稍后再试'},UNKNOWN_MSG='网络错误，请稍后再试',undefined;var ret_msgs={get:function(code){var msg=MAP[code];if(msg===false){return'';}else{return msg||UNKNOWN_MSG;}},is_sess_timeout:function(code){return code===1024||code===10000||code===190051||code===4000;},is_indep_invalid:function(code){return code===1031;},UNKNOWN_MSG:UNKNOWN_MSG,TIMEOUT_CODE:404,UNKNOWN_CODE:1000,INVALID_SESSION:1024,INVALID_SESSION2:10000,INVALID_INDEP_PWD:1031,INCOMPLETE_FILE:3002,EMPTY_FILE:3008,SHARE_FILE_OVER_SIZE:1070,FILE_NOT_EXIST:1020};return ret_msgs;});define.pack("./ui.center",["lib","common","$"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),collections=lib.get('./collections'),console=lib.get('./console'),$win=$(window),ie6=$.browser.msie&&$.browser.version<7,listen,stop_listen,update,undefined;if(ie6){update=function(el,fix_x,fix_y){setTimeout(function(){var $el=$(el);if($el.is(':visible')){var wh=get_width_height($el),win_width=$win.width(),win_height=$win.height(),fix_x=fix_x||0;fix_y=fix_y||0;$el.css({position:'absolute',left:(win_width-wh[0]+fix_x)/2,top:(win_height-wh[1]+fix_y)/2+$win.scrollTop(),margin:'auto'});}},0);};listen=function(el,fix_x,fix_y){stop_listen(el);var $el=$(el),center_id=$el.data('center_id');if(!center_id){$el.data('center_id',center_id=random());}
var event_names=['resize.ui.center_'+center_id].join(' ');$win.bind(event_names,function(e){update($el,fix_x,fix_y);});update($el,fix_x,fix_y);};stop_listen=function(el){var $el=$(el),center_id=$el.data('center_id');if(center_id){$el.removeData('center_id');var event_names=['resize.ui.center_'+center_id].join(' ');$win.unbind(event_names);}};}
else{listen=update=function(el,fix_x,fix_y){setTimeout(function(){var $el=$(el);if($el.is(':visible')){var wh=get_width_height($el),fix_x=fix_x||0;fix_y=fix_y||0;$el.css({position:'fixed',left:'50%',top:'50%',marginLeft:-(wh[0]/2+fix_x)+'px',marginTop:-(wh[1]/2+fix_y)+'px'});}},0);};stop_listen=$.noop;}
var
random=function(){return new Date().getTime()+Math.round(Math.random()*1000000);},get_width_height=function($el){var w=$el.outerWidth(),h=$el.outerHeight();return[w,h];};return{listen:listen,stop_listen:stop_listen,update:update};});define.pack("./ui.column_model.column",["lib","$"],function(require,exports,module){var lib=require('lib'),$=require('$'),default_column_options={field:'',klass:'',title:'',val_get:null},undefined;var Column=function(options){this.options=$.extend({},default_column_options,options);};return Column;});define.pack("./ui.column_model.column_model",["lib","common","$","./ui.column_model.column","./ui.column_model.ui"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),collections=lib.get('./collections'),console=lib.get('./console'),text=lib.get('./text'),events=lib.get('./events'),Column=require('./ui.column_model.column'),ColumnModelUI=require('./ui.column_model.ui'),default_column_model_options={el:null,cols:[],default_field:null,default_order:'desc',get_datas:$.noop,klass:'',visible:true},undefined;var strCmpLogical=(function(){var match={},digits=['+','-',0,1,2,3,4,5,6,7,8,9],digitMap={},digitRe=/^([+-]|[0-9]+)/;$.each(digits,function(index,value){digitMap[value]=match;});return function(str1,str2){var i1=0,i2=0,c1,c2,int1,int2,len1,len2;if(str1&&str2){while(i1<str1.length){c1=str1.charAt(i1);if(i2>=str2.length){return 1;}
c2=str2.charAt(i2);if(digitMap[c1]===match){if(digitMap[c2]!==match){return-1;}
int1=str1.substr(i1).match(digitRe)[1];int2=str2.substr(i2).match(digitRe)[1];len1=int1.length;len2=int2.length;int1=parseInt(int1,10);int2=parseInt(int2,10);if(c1==='+'){int1=-2;}else if(c1==='-'){int1=-1;}
if(c2==='+'){int2=-2;}else if(c2==='-'){int2=-1;}
if(int1>int2){return 1;}else if(int1<int2){return-1;}else{if(len1>len2){return-1;}else if(len1<len2){return 1;}}
i1+=len1;i2+=len2;}else if(digitMap[c2]===match){return 1;}else{c1=c1.toLowerCase();c2=c2.toLowerCase();if(c1>c2){return 1;}else if(c1<c2){return-1;}
i1++;i2++;}}}
return 0;};})();var ColumnModel=function(options){this.options=$.extend({},default_column_model_options,options);var opts=this.options;this._cur_field=opts.default_field;this._cur_order=opts.default_order;$.each(opts.cols,function(i,col){if(!(col instanceof Column)){opts.cols[i]=new Column(col);}});if(!opts.default_field){console.error('ColumnModel缺少有效的default_field参数');}
if(!opts.default_order){console.error('ColumnModel缺少有效的default_order参数');}
if(!$.isFunction(opts.get_datas)){console.error('ColumnModel缺少有效的get_datas参数');}};ColumnModel.prototype={render:function(){var me=this;},sort_datas:function(datas,field,order){var me=this;field=field||me._cur_field;order=order||me._cur_order;datas=me._sort(datas,field,order);if($.isFunction(me.options.after_sort)){datas=me.options.after_sort(datas,field,order);}
return datas;},sort:function(field,order){var me=this;if(field!=me._cur_field){order=order||me.options.default_order;}
else{if(!order){order=me._cur_order=='desc'?'asc':'desc';}}
if(field===me._cur_field&&order===me._cur_order){return;}
var datas=me._sort(me.options.get_datas(),field,order);me._cur_field=field;me._cur_order=order;if($.isFunction(me.options.after_sort)){datas=me.options.after_sort(datas,field,order);}
me.trigger('sorted',datas,field);},_sort:function(datas,field,order){var asc=order==='asc';if(datas&&datas.length){var col=collections.first(this.options.cols,function(c){return c.options.field===field;});if(!col){return;}
var val_get=col.options.val_get,great=1,less=-1,equal=0,skip=false,ahead=asc?less:great,behind=asc?great:less,before_comparator=this.options.before_comparator,after_comparator=this.options.after_comparator,comparator=function(node1,node2){var result;if(before_comparator){result=before_comparator(node1,node2);if(result===skip){return equal;}
if(result!==equal){return result;}}
var value1=val_get.call(col,node1),value2=val_get.call(col,node2);result=value1===value2?equal:(value1<value2?ahead:behind);if(result===equal&&after_comparator){return after_comparator(node1,node2);}
return result;};for(var i=0,l=datas.length;i<l;i++){if(datas[i]){datas[i]=datas[i].slice(0).sort(comparator);}}}
return datas;},get_field:function(){return this._cur_field;},get_order:function(){return this._cur_order;},toggle:function(visible){}};$.extend(ColumnModel.prototype,events);return ColumnModel;});define.pack("./ui.column_model.ui",["lib","common","$","./tmpl"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),collections=lib.get('./collections'),console=lib.get('./console'),text=lib.get('./text'),events=lib.get('./events'),tmpl=require('./tmpl'),asc='asc',desc='desc',default_options={el:null,cols:[],default_field:'',default_order:'',klass:'',visible:true},undefined;var ColumnModelUI=function(options){this.options=$.extend(true,{},default_options,options);};ColumnModelUI.prototype={render:function(){var me=this;this._$el=me._init_$doms();$(me.options.el).empty().append(this._$el);this._$el.on('click.column_model','[data-field]',function(e){e.preventDefault();var $handler=$(this),$a=$handler.children('a'),field=$handler.attr('data-field'),order=$a.hasClass(asc)?desc:($a.hasClass(desc)?asc:me.options.default_order);me.trigger('sort',field,order);$a.toggleClass(asc,order===asc).toggleClass(desc,order===desc);$handler.siblings().children('a').removeClass('desc asc');});},toggle:function(visible){this._$el.toggle(visible);},_init_$doms:function(){var opts=this.options;var ttt=new Date().getTime();var $el=$(tmpl.ui_column_model({field:opts.default_field,order:opts.default_order,cols:opts.cols,klass:opts.klass}));return $el;}};$.extend(ColumnModelUI.prototype,events);return ColumnModelUI;});define.pack("./ui.context_menu",["lib","$","./tmpl","./global.global_event"],function(require,exports,module){var lib=require('lib'),$=require('$'),console=lib.get('./console'),template=lib.get('./template'),collections=lib.get('./collections'),Events=lib.get('./events'),tmpl=require('./tmpl'),global_event=require('./global.global_event'),$win=$(window),DEFAULT_CONTEXTMENU_CONFIG={items:[]},DEFAULT_ITEM_CONFIG={id:'',icon_class:'',text:'',after_render:$.noop,group:''},seq=0,fix_header_height=0,undefined;global_event.on('page_header_height_resize',function(new_height){fix_header_height=new_height;});var ContextMenu=function(config){var me=this;me.config=$.extend({},DEFAULT_CONTEXTMENU_CONFIG,config);me._all_items=$.map(me.config.items,function(item){if(!(item instanceof Item)){item=new Item(item);}
return item;});};ContextMenu.prototype={render:function(item_id_map,arrow,$to){var me=this;me.hide(false);var render_items;if(item_id_map){render_items=$.grep(me._all_items,function(item){return item.config.id in item_id_map;});}else{render_items=me._all_items;}
$to=$($to);me.$el=$(tmpl.context_menu({items:render_items,arrow:arrow})).hide().appendTo($to.length?$to:document.body);me.$el.on('click.context_menu','[data-action=item]',function(e){var link=$(this).find('a');if(link.is('a[href^=#],a[href^="javascript:"]')){e.preventDefault();}
var id=$(this).attr('data-item-id'),item=collections.first(render_items,function(item){if(item.config.id==id){return item;}});if(item){item.trigger('click',e);}
me.trigger('item_click',item,e);me.hide();});$.each(render_items,function(i,item){item.trigger('after_render',$('>ul>li[data-action=item]:eq('+i+')',me.$el));});return me.$el;},show:function(x,y,item_id_map){this.render(item_id_map,false);var xy=this._fix_xy(x,y);this._show(xy);this.trigger('show');},show_on:function($on,$offs_par,item_ids,fix_left,fix_top,fix_bottom){$on=$($on);var
on_offs=$on.offset(),par_offs=$offs_par.offset(),x=on_offs.left+$on.width()/2,y=on_offs.top+$on.height()/2;this.render(item_ids,true,$offs_par);var xy=this._fix_xy(x,y);if(xy.at_top){xy.y+=fix_top;}else if(xy.at_bottom){xy.y+=fix_bottom;}
xy.x-=fix_left;xy.x-=par_offs.left;xy.y-=par_offs.top;this._show(xy);this.trigger('show_on',$on);},_show:function(xy){var me=this;var $el=this.$el;$el.css({left:xy.x+'px',top:xy.y+'px',zIndex:$el.css('zIndex')+1,display:'none'}).fadeIn(150);$el.toggleClass('ui-popmenu-bottom',xy.at_top);setTimeout(function(){$(document.body).on('mousedown.context_menu',function(e){var in_menu=$(e.target).closest(me.$el).length;if(!in_menu){me.hide();}});},0);},hide:function(fade){var me=this;if(me.$el){if(fade!==false){me.$el.stop(true,true).fadeOut(150,function(){$(this).remove();});}else{me.$el.remove();}}
$(document.body).off('mousedown.context_menu');this.trigger('hide');},_fix_xy:function(x,y){var $el=this.$el,el_width=$el.outerWidth(),el_height=$el.outerHeight(),win_width=$win.width(),win_height=$win.height(),x_scroll=$win.scrollLeft(),y_scroll=$win.scrollTop(),fix_padding=5,x_limit=win_width+x_scroll-fix_padding,y_limit=win_height+y_scroll-fix_padding,at_bottom=true,at_right=true;if(x+el_width>x_limit){x-=el_width;at_right=false;}
if(y+el_height>y_limit){y-=el_height;at_bottom=false;}
return{x:x,y:y,at_top:!at_bottom,at_bottom:at_bottom,at_left:!at_right,at_right:at_right};}};$.extend(ContextMenu.prototype,Events);var Item=function(_config){var me=this,config=me.config=$.extend({},DEFAULT_ITEM_CONFIG,_config);if($.isFunction(config.click)){me.on('click',function(e){config.click.call(me,e);});}
if($.isFunction(config.after_render)){me.on('after_render',function(){config.after_render.apply(me,$.makeArray(arguments));})}};$.extend(Item.prototype,Events);ContextMenu.Item=Item;return ContextMenu;});define.pack("./ui.flash_focus_hacker",["$"],function(require,exports,module){var $=require('$');return{fix:function(){$('<button style="width:0;height:0;position:absolute;left:-100px;top:-100px;"/>').appendTo(document.body).focus().remove();}}});define.pack("./ui.ie_click_hacker",["$"],function(require,exports,module){var $=require('$'),ie=$.browser.msie;if(ie){var mouse_down_time,during=400,D=Date,undef;$(function(){$(document.body).on('mousedown',function(){mouse_down_time=new D().getTime();});});return{is_click_event:function(){return new D().getTime()-mouse_down_time<during;}};}
else{return{is_click_event:function(){return true;}};}});define.pack("./ui.mini_tip",["lib","common","$"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),collections=lib.get('./collections'),console=lib.get('./console'),text=lib.get('./text'),events=lib.get('./events'),easing=lib.get('./ui.easing'),delay_min=3,delay_max=6,second_every_letter=1,t,$el,el_height=30,inited,animate_easing=easing.get('easeOutExpo'),undefined;var mini_tip={init_if:function(){if(!inited){$el=$('<div class="ui-tips" style="display:none;"></div>');var $fix_header=$('#_main_fixed_header');$el.appendTo($fix_header[0]||document.body);inited=true;}},_msg:function(type,msg,second){if(!msg)
return;this.init_if();msg=msg.toString();clearTimeout(t);$el.removeClass('ui-tips-ok ui-tips-warn ui-tips-err').addClass('ui-tips-'+type).html(msg).css('visibility','hidden').css('display','').css('left','50%').css('margin-left',(-$el.width()/2)+'px').stop(true,true).css('margin-top',-el_height).animate({'margin-top':0},400,animate_easing).delay(0).css('visibility','');var delay=second>0?second:Math.min(Math.max(msg.length*second_every_letter,delay_min),delay_max);t=setTimeout(function(){$el.animate({'margin-top':-el_height},400,animate_easing,function(){$el.hide().empty();});},delay*1000);},ok:function(msg,sec){this._msg('ok',msg,sec);},warn:function(msg,sec){this._msg('warn',msg,sec);},error:function(msg,sec){this._msg('err',msg,sec);}};return mini_tip;});define.pack("./ui.paging_helper",["lib","common","$"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),console=lib.get('./console').namespace('paging'),global_event=common.get('./global.global_event'),$win=$(window),M=Math,win_width=$win.width(),win_height=$win.height(),reach_bottom_px=300,min_line_count_list=6,min_line_count_thumb=2,default_options={$container:null,item_width:0,item_height:0,fixed_height:0},undef;var Paging_Helper=function(opts){var o=this._options=$.extend({},default_options,opts);o.$container=$(o.$container);};Paging_Helper.prototype={get_line_size:function(){var o=this._options,line_size=o.is_list||!(o.item_width>0)?1:M.max(M.floor(o.$container.width()/o.item_width),1);console.log('line_size',line_size);return line_size;},get_line_count:function(is_first_page){var
o=this._options,min_line_count=o.is_list?min_line_count_list:min_line_count_thumb,line_count=is_first_page?M.floor((win_height-o.fixed_height)/o.item_height)+min_line_count:min_line_count;console.log('line_count',line_count);return line_count;},is_reach_bottom:function(){var scroll_top=$win.scrollTop(),doc=document,win_height=$win.height(),doc_height=doc.documentElement.scrollHeight;return scroll_top+win_height>=doc_height-reach_bottom_px;},set_is_list:function(is_list){this._options.is_list=is_list;},set_item_width:function(item_width){this._options.item_width=item_width;if(item_width===0||item_width==='auto'){this._options.is_list=true;}},set_item_height:function(item_height){this._options.item_height=item_height;},set_fixed_height:function(fixed_height){this._options.fixed_height=fixed_height;},set_$container:function($container){this._options.$container=$($container);}};global_event.on('window_resize',function(){win_width=$win.width();win_height=$win.height();});return Paging_Helper;});define.pack("./ui.progress",["lib","common","$","./ui.widgets","./tmpl","./ui.center"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),template=lib.get('./template'),widgets=require('./ui.widgets'),tmpl=require('./tmpl'),ui_center=require('./ui.center'),timer,undefined;var progress={$el:null,render_if:function(){if(!this.$el){this.$el=$(tmpl.loading_mark()).hide().appendTo(document.body);}},show:function(msg,delay_to_hide,white_mask,id){clearTimeout(timer);var me=this;me.render_if();var $el=me.$el;if(!$el.parent()[0]){$el.appendTo(document.body).hide();}
$el.find('._n').html(msg);if(!msg){me.hide();}
else{if($el.is(':hidden')){$el.fadeIn('fast');ui_center.listen($el);this.mask(true,white_mask);}
if(delay_to_hide){var delay=1;if(typeof delay_to_hide=='number'){delay=delay_to_hide;}
timer=setTimeout(function(){me.hide();},delay*1000);}
this._cur_id=id||undefined;}},hide:function(mask){if(this.$el){this.$el.stop(true,true).fadeOut('fast',function(){var $el=$(this);ui_center.stop_listen($el);$el.detach();});}
if(mask!==false){this.mask(false);}},hide_if:function(mask,id){if(this._cur_id&&this._cur_id===id){this.hide(mask);}},mask:function(visible,white_mask){white_mask=white_mask!==false;widgets.mask.toggle(visible,'ui.progress',this.$el,white_mask);}};return progress;});define.pack("./ui.scroller",["lib","common","$","./tmpl"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),collections=lib.get('./collections'),console=lib.get('./console'),text=lib.get('./text'),events=lib.get('./events'),easing=lib.get('./ui.easing'),Module=common.get('./module'),widgets=common.get('./ui.widgets'),tmpl=require('./tmpl'),default_speed='slow',undefined;var scroller=new Module('scroller',{top:function(callback){this.go(0,callback);},go:function(y,speed,callback){if(typeof arguments[1]==='function'){callback=arguments[1];speed=undefined;}
var $el=$('html, body');if(speed!=0){$el.animate({scrollTop:y},{during:speed||default_speed,easing:easing.get('easeOutExpo'),complete:callback});}else{$el.scrollTop(0);}}});return scroller;});define.pack("./ui.widgets",["lib","common","$","./tmpl","./constants","./global.global_event","./ui.center"],function(require,exports,module){var lib=require('lib'),common=require('common'),$=require('$'),template=lib.get('./template'),console=lib.get('./console'),events=lib.get('./events'),tmpl=require('./tmpl'),constants=require('./constants'),global_event=require('./global.global_event'),page_event=require('./global.global_event').namespace('page'),ui_center=require('./ui.center'),$win=$(window),$doc=$(document),dam_ie6=$.browser.msie&&$.browser.version<7,KEYPRESS_EVENT_NAME=dam_ie6?'keypress':'keydown',undefined;exports.confirm=function(title,msg,desc,ok_callback,cancel_callback,button_texts){var $el=$('#_widgets_confirm');if($el[0]){$el.remove();}
if(!$.isArray(button_texts)){button_texts=[];}
$el=$(tmpl.confirm({title:title,msg:msg,desc:desc,button_texts:button_texts})).appendTo(document.body);var
ok=function(){toggle(false);if($.isFunction(ok_callback))
ok_callback();},cancel=function(){toggle(false);if($.isFunction(cancel_callback))
cancel_callback();},toggle=function(visible){if(visible){$el.fadeIn('fast');ui_center.listen($el);}else{$el.fadeOut('fast',function(){ui_center.stop_listen($el);$el.remove();});}
mask.toggle(visible,'ui.widgets.confirm');};toggle(true);$el.find(':button._ok').focus();$el.on('click.widgets_confirm',':button._ok',function(e){e.preventDefault();ok();});$el.on('click.widgets_confirm','a._x,:button._x',function(e){e.preventDefault();cancel();});$el.on(KEYPRESS_EVENT_NAME+'.widgets_confirm',function(e){if(e.which==27){cancel();}});require.async('jquery_ui',function(){if(!$el.parent()[0]){return;}
$el.draggable({handle:'.ui-xbox-title, .ui-xbox-foot',cancel:'a, button, input',containment:'document',start:function(){ui_center.stop_listen($el);}});});};exports.alert=function(options){new Dialog({title:options.title,content:$(tmpl.alert_dialog_content({type:options.type,msg:options.msg,desc:options.desc})),destroy_on_hide:true,buttons:[{id:'OK',text:options.button_text||'确定',klass:'ui-btn-ok',disabled:false,visible:true}],handlers:{OK:function(){this.hide();if($.isFunction(options.ok)){options.ok();}}}}).show();};exports.alert.ok=function(options){return exports.alert($.extend(options,{type:'ok'}));};exports.alert.info=function(options){return exports.alert($.extend(options,{type:'info'}));};exports.alert.warn=function(options){return exports.alert($.extend(options,{type:'warn'}));};var mask=exports.mask={_namespaces:{},show:function(namespace,under_$el,white){this.toggle(true,namespace,under_$el,white);},hide:function(namespace){this.toggle(false,namespace);},toggle:function(visible,namespace,under_$el,white){if(typeof visible!=='boolean'){return;}
white=white===true;var namespaces=this._namespaces,cur_showing=namespace in namespaces;if(visible===cur_showing){return;}
var
me=this,$append_to=$($('#_main_fixed_header')[0]||document.body),$mask_el=me._$mask||(me._$mask=$(tmpl.mask()).hide().appendTo($append_to)),position=$.browser.msie&&$.browser.version<7?'absolute':'fixed';$mask_el.stop().css({top:0,left:0,position:position,width:'100%',height:$win.height()});me.stopListening(global_event,'window_resize');if(dam_ie6){me.stopListening(global_event,'window_scroll');}
if(visible){$mask_el.toggleClass('ui-mask-white',!!white);if(!$mask_el.is(':visible')){$mask_el.css({opacity:0,display:'block'});}
$mask_el.animate({opacity:.65},'fast');me.listenTo(global_event,'window_resize',function(){$mask_el.height($win.height());});if(under_$el){var z_index=parseInt($mask_el.css('z-index'));if(z_index){$(under_$el).css('z-index',z_index+1);}}
namespaces[namespace]=true;}
else{delete namespaces[namespace];if($.isEmptyObject(namespaces)){$mask_el.animate({opacity:0},'fast',function(){$(this).css({opacity:'',display:'none'});});}}}};$.extend(mask,events);page_event.on('check_file_upload_draggable',function(){return $.isEmptyObject(mask._namespaces);});var Dialog=exports.Dialog=(function(){var
DEFAULTS={klass:'',title:'',content:'',animate:true,module:true,empty_on_hide:false,destroy_on_hide:false,no_doc_wheel:false,buttons:['OK','CANCEL'],movable:true,handlers:null},DEFAULT_BUTTONS={OK:{id:'OK',text:'确定',klass:'ui-btn-ok',disabled:false,visible:true,submit:true},CANCEL:{id:'CANCEL',text:'取消',klass:'ui-btn-cancel',disabled:false,visible:true},CLOSE:{id:'CLOSE',text:'关闭',klass:'ui-btn-cancel',disabled:false,visible:true}},Dialog=function(config){this.config=$.extend({},DEFAULTS,config);};Dialog.prototype={_rendered:false,_visible:false,render_if:function(){var me=this;if(!me._rendered){me._rendered=true;var
config=me.config,$el;var buttons=$.map(config.buttons,function(btn){if(typeof btn=='string'){return DEFAULT_BUTTONS[btn];}else{return btn.id?btn:undefined;}});$el=me.$el=$(tmpl.dialog({config:config,buttons:buttons})).hide().appendTo(document.body);var $foot=$el.find('div.__buttons');me.$buttons=$foot.children(':button,:submit');me.$msg=$foot.children('.__msg');if(config.handlers){$.each(buttons,function(i,btn){if(btn!==DEFAULT_BUTTONS.CANCEL&&btn!==DEFAULT_BUTTONS.CLOSE)
$el.on('click',':button[data-btn-id="'+btn.id+'"]',$.proxy(config.handlers[btn.id]||$.noop,me));});}
$.each(buttons,function(i,button){me.set_button_visible(button.id,button.visible);me.set_button_enable(button.id,!button.disabled);});$el.on('click','[data-btn-id=CANCEL], [data-btn-id=CLOSE]',function(e){e.preventDefault();me.hide(false);});$el.on('keyup',function(e){if(e.which===13&&config.handlers['OK']&&!$(e.target).closest('button, a')[0]){config.handlers['OK'].call(me);}});if(config.content){me.set_content(config.content);}
this.trigger('render');}},show:function(){if(this._visible){return;}
var me=this;me.render_if();me.config.animate?me.$el.fadeIn('fast',function(){me.trigger('after_show',me.$el);}):me.$el.show();if(me.config.no_doc_wheel)
me.no_doc_wheel(true);if(me.config.module){mask.show('ui.widgets.Dialog');}
me.enable_esc(true);ui_center.listen(me.$el);if(me.config.movable){require.async('jquery_ui',function(){if(!me.$el||!me.$el.parent()[0]){return;}
me.$el.draggable({handle:'.ui-xbox-title, .ui-xbox-foot',cancel:'a, button, input',containment:'document',start:function(){ui_center.stop_listen(me.$el);}});});}
this._visible=true;this.trigger('show');},hide:function(callback){if(!this._visible){return;}
var me=this,config=me.config;var after_hide=function(){me.hide_msg();if(me.config.no_doc_wheel)
me.no_doc_wheel(false);me.enable_esc(false);if(config.module){mask.hide('ui.widgets.Dialog');}
ui_center.stop_listen(me.$el);if(config.empty_on_hide){me.set_content('');}
me._visible=false;me.trigger('hide');if(config.destroy_on_hide){me.destroy();}};me.$el.fadeOut(config.animate?'fast':0,function(){after_hide();});},set_class:function(klass){this.render_if();var cls=this.$el.attr('class');this.$el.attr('class',cls.substr(0,cls.indexOf('__')+'__'.length)+' '+klass);},set_title:function(title){this.render_if();this.$el.find('.__title').text(title);},set_content:function(content){var me=this;me.render_if();var
config=me.config,$el=me.$el,$content=me.get_$body().empty();if(typeof content=='string'||(content instanceof $)||(content.tagName&&content.nodeType)){$content.append(config.content);}else if(typeof content=='function'){$content.append(content());}else{console.error('widgets.Dialog.set_content(content)','无效的content参数：',content);}
this.trigger('update_content');},set_button_enable:function(button_id,enable){enable=enable!==false;var $btn=this.$buttons.filter('[data-btn-id="'+button_id+'"]');$btn.toggleClass('disabled',!enable);if(enable){$btn.removeAttr('disabled');}else{$btn.attr('disabled','disabled');}},set_button_visible:function(button_id,visible){this.$buttons.filter('[data-btn-id="'+button_id+'"]').toggle(visible);},error_msg:function(msg){var $msg=this.$msg;var time=5000;$msg.removeClass('ui-tips-ok ui-tips-warn').addClass('ui-tips-err').text(msg).fadeIn('fast');clearTimeout(this.$msg.data('timer'));$msg.data('timer',setTimeout(function(){$msg.stop(true,true).fadeOut('fast');},time));},hide_msg:function(){clearTimeout(this.$msg.data('timer'));this.$msg.stop(true,true).fadeOut('fast');},destroy:function(){if(this.$el){this.$el.remove();this.$el=null;this.trigger('destroy');this.off().stopListening();}},submit:function(){this.trigger('submit');},no_doc_wheel:function(disable){$('html, body').css('overflow-y',disable?'hidden':'');},enable_esc:function(esc){$doc.off(KEYPRESS_EVENT_NAME+'.widgets_Dialog');if(esc){var me=this;$doc.on(KEYPRESS_EVENT_NAME+'.widgets_Dialog',function(e){if(e.which==27){me.hide();}});}},set_height:function(h){this.$el.height(h);},get_height:function(){return this.$el.outerHeight();},focus_button:function(btn_id){this.$buttons.filter('[data-btn-id="'+btn_id+'"]').focus();},is_visible:function(){return!!this._visible;},get_$body:function(){return $('div.__content',this.$el);}};$.extend(Dialog.prototype,events);return Dialog;})();exports.loading={_get_top:function(){var win_top=$(window).scrollTop(),wrap_top=$('#_main_wrapper').position().top,visable_height=window.innerHeight&&!$.browser.msie?window.innerHeight:document.documentElement.clientHeight;return((visable_height-wrap_top)/2)+wrap_top+win_top;},show:function(){var $el=this._get_$el(),h=$el.height(),w=$el.width();$el.addClass('icon-loading').css({left:'50%',top:this._get_top(),marginLeft:(this._get_wrap_left()-w)/2+'px',marginTop:-h/2+'px',display:'block'});},hide:function(){this._get_$el().hide();},_get_wrap_left:function(){return constants.IS_APPBOX?0:$('#_main_nav').width()||0;},_get_$el:function(){return this._$el||(this._$el=$('<div/>').css({position:'absolute',display:'none'}).appendTo(document.body));}};});define.pack("./urls",["lib","./constants"],function(require,exports,module){var lib=require('lib'),JSON=lib.get('./json'),undefined;module.exports={redirect:function(url,params){location.href=this.make_url(url,params);},make_url:function(url,params,encode_value){url=this.absolute_url(url);var params_str=this.make_params(params,encode_value);var suffix=url.indexOf('?')>-1?'&':'?';return url+(params_str?suffix+params_str:'');},make_params:function(params,encode_value){if(typeof params=='object'){var p=[],encode=encodeURIComponent;for(var key in params){var value=params[key];if(value==undefined){value='';}
if(typeof value=='object'){value=JSON.stringify(value);p.push(encode(key)+'='+encode(value));}
else{value=value.toString();p.push(encode(key)+'='+(encode_value!==false?encode(value):value));}}
return p.join('&');}
return'';},absolute_url:function(url){var constants=require('./constants');if(!reg_abs_url.test(url)){url=constants.DOMAIN+(url.charAt(0)=='/'?url:'/'+url);}
return url;},cur_url:function(){return location.href;}};var reg_abs_url=/^https?:\/\//;});define.pack("./user_log",["lib","common","$","./constants","./query_user","./urls","./configs.ops"],function(require,exports,module){var
lib=require('lib'),common=require('common'),$=require('$'),JSON=lib.get('./json'),console=lib.get('./console'),image_loader=lib.get('./image_loader'),constants=require('./constants'),query_user=require('./query_user'),urls=require('./urls'),ops=require('./configs.ops'),VERSION_NO=constants.IS_APPBOX?0:1,OS_TYPE=constants.APPID,DEVICE_TYPE=constants.IS_APPBOX?9002:9001,SERVICE_ID=1,base_params={extString1:constants.OS_NAME,extString2:constants.BROWSER_NAME+($.browser.msie?parseInt($.browser.version):'')},undefined;if(VERSION_NO==null){console.warn('获取 VERSION_NO 失败');}
if(OS_TYPE==null){console.warn('获取 OS_TYPE 失败');}
if(SERVICE_ID==null){console.warn('获取 SERVICE_ID 失败');}
var default_headers={cmd:'wy_log_flow_bat',dev_id:DEVICE_TYPE,os_type:OS_TYPE,dev_type:DEVICE_TYPE,client_ip:'',weiyun_ver:'',source:'weiyunWeb',os_ver:'',msg_seq:1,proto_ver:2,rsp_compressed:1,encrypt:0,net_type:0};var cgi_url='http://tj.cgi.weiyun.com/wy_log.fcg';var oz_op_log=function(op_or_name,ret,params,extra_config){var op=typeof op_or_name==='number'?op_or_name:(ops.get_oz_op_by_name(op_or_name)||ops.get_click_op_by_name(op_or_name));if(!op){console.error('user_log() 无效的参数 op');return;}
var header=$.extend({uin:query_user.get_uin_num()},default_headers);if(extra_config){$.extend(header,extra_config);}
var body={log_data:[$.extend({op:op,rst:ret||0,service_id:SERVICE_ID,subop:0},base_params,params)]};var data_str=JSON.stringify({req_header:header,req_body:body});image_loader.load(urls.make_url(cgi_url,{op:op,data:data_str}));};oz_op_log.set_base_param=function(key,value){base_params[key]=value;};oz_op_log.pitch_log=function(data){var header=$.extend({uin:query_user.get_uin_num()},default_headers);var body={log_data:data};var data_str=JSON.stringify({req_header:header,req_body:body});image_loader.load(urls.make_url(cgi_url,{data:data_str}));};return oz_op_log;});define.pack("./util.functional",[],function(require,exports,module){var proto=Function.prototype,slice=Array.prototype.slice,join=Array.prototype.join,functional={};functional.uncurrying=function(fn){return function(){return proto.call.apply(fn,arguments);};};functional.bind=function(fn,context){var args=slice.call(arguments,2);return function(){return fn.apply(context,args.concat(slice.call(arguments)));};};functional.before=function(before,fn){return function(){if(fn.apply(this,arguments)===false){return false;}
return before.apply(this,arguments);};};functional.after=function(fn,after){return function(){var ret=fn.apply(this,arguments);if(ret===false){return false;}
after.apply(this,arguments);return ret;};};functional.wrap=function(before,fn,after){return function(){if(before.apply(this,arguments)===false){return false;}
var ret=fn.apply(this,arguments);if(ret===false){return false;}
after.apply(this,arguments);return ret;};};functional.currying=function(fn){var __args=[];return function(){if(arguments.length===0){return fn.apply(this,__args);}
[].push.apply(__args,arguments);return arguments.callee;};};functional.getSingle=function(fn){var ret;return function(){return ret||(ret=fn.apply(this,arguments));};};functional.throttle=function(fn,interval){var __self=fn,timer,firstTime=true;return function(){var args=arguments,__me=this;if(firstTime){__self.apply(__me,args);return firstTime=false;}
if(timer){return false;}
timer=setTimeout(function(){clearTimeout(timer);timer=null;__self.apply(__me,args);},interval);};};functional.cache=function(fn){var __self=fn,paramCache={},retCache={};return function(){var paramStr=join.call(arguments);if(paramCache[paramStr]){return retCache[paramStr];}
paramCache[paramStr]=true;return retCache[paramStr]=__self.apply(this,arguments);};};functional.delay=function(fn,timer){if(fn){setTimeout(function(){fn();},timer);}};functional.try_it=function(fn){try{return fn();}catch(e){return void(0);}};functional.burst=function(ary,fn,len){var obj,start,t;var run=function(){for(var i=0;i<len;i++){obj=ary.shift();if(!obj){return false;}
fn.call(obj,obj);}};start=function(){if(run()===false){return;}
t=setInterval(function(){if(run()===false){return clearInterval(t);}},200);};return{start:start};};return functional;});define.pack("./tmpl",[],function(require,exports,module){var tmpl={'ui_column_model':function(data){var __p=[],_p=function(s){__p.push(s)};__p.push('    ');var lib=require('lib'),$=require('$'),text=lib.get('./text'),field=data.field,order=data.order,klass=data.klass,cols=data.cols;__p.push('\r\n\
    <div data-no-selection class="sortable file-sorting ');_p(klass);__p.push('" ');_p(data.visible?'':'display:none;');__p.push('>\r\n\
        <ul>');$.each(cols,function(i,col){var opts=col.options,enable=!!opts.val_get;__p.push('                <li data-field="');_p(opts.field);__p.push('" class="');_p(opts.klass);__p.push('">');if(i>0){__p.push('<s class="border"></s>');}__p.push('                    <a class="by ');_p(field==opts.field?order:'');__p.push('" href="#" hidefocus="on">');_p(text.text(opts.title));if(enable){__p.push('<i></i>');}__p.push('</a>\r\n\
                </li>');});__p.push('        </ul>\r\n\
    </div>');return __p.join("");},'context_menu':function(data){var __p=[],_p=function(s){__p.push(s)};__p.push('    ');var lib=require('lib'),$=require('$'),common=require('common'),click_tj=common.get('./configs.click_tj'),arrow=data.arrow,items=data.items||[],length=items.length;__p.push('    <div data-no-selection class="ui-popmenu context-menu">\r\n\
        <ul>');$.each(items,function(i,item){__p.push('                <li data-action="item" data-item-id="');_p(item.config.id);__p.push('" ');_p(click_tj.make_tj_str(item.config.tj_id));__p.push('><a href="javascript:void(0);" hidefocus="on"><i class="');_p(item.config.icon_class);__p.push('"></i><span data-action="text">');_p(item.config.text);__p.push('</span></a></li>');if(i<length-1){__p.push('                    ');if(items[i+1].config.group!==item.config.group){__p.push('                        <li class="split"></li>');}__p.push('                ');}__p.push('            ');});__p.push('        </ul>');if(arrow){__p.push('            <s class="ui-arr"></s>\r\n\
            <s class="ui-arr ui-tarr"></s>');}__p.push('    </div>');return __p.join("");},'loading_mark':function(data){var __p=[],_p=function(s){__p.push(s)};__p.push('    <div data-no-selection class="ui-waiting">\r\n\
        <i class="icon-loading"></i>\r\n\
        <span class="_n ui-text"></span>\r\n\
    </div>');return __p.join("");},'confirm':function(data){var __p=[],_p=function(s){__p.push(s)};__p.push('    ');var lib=require('lib'),text=lib.get('./text');__p.push('    <div id="_widgets_confirm" data-no-selection class="ui-xbox ui-confirm" style="display:none;">\r\n\
        <div class="ui-shadow"></div>\r\n\
        <div class="ui-xbox-inner">\r\n\
            <div class="ui-xbox-wrap">\r\n\
                <h3 class="_title ui-xbox-title">');_p(text.text(data.title));__p.push('</h3>\r\n\
                <div class="ui-xbox-cnt">\r\n\
                    <div class="ui-confirm-cnt">\r\n\
                        <i class="icon-xbox icon-xbox-warn"></i>\r\n\
                        <h4 class="ui-title">');_p(text.text(data.msg));__p.push('</h4>\r\n\
                        <div class="ui-text">');_p(text.text(data.desc));__p.push('</div>\r\n\
                    </div>\r\n\
                </div>\r\n\
                <div class="ui-xbox-foot">\r\n\
                    <input type="button" class="_ok ui-btn-ok" value="');_p(data.button_texts[0]?text.text(data.button_texts[0]):'确定');__p.push('"/>\r\n\
                    <input type="button" class="_x ui-btn-cancel" value="');_p(data.button_texts[1]?text.text(data.button_texts[1]):'取消');__p.push('"/>\r\n\
                </div>\r\n\
            </div>\r\n\
            <a class="_x icon-close ui-xbox-close" href="javascript:void(0)">×</a>\r\n\
        </div>\r\n\
    </div>');return __p.join("");},'mask':function(data){var __p=[],_p=function(s){__p.push(s)};__p.push('    <div id="_widgets_mask" data-no-selection class="ui-mask" style="display:none;"></div>');return __p.join("");},'dialog':function(data){var __p=[],_p=function(s){__p.push(s)};__p.push('    ');var $=require('$'),lib=require('lib'),text=lib.get('./text'),inner_tag=data.config.form_dialog?'form':'div';__p.push('    <div data-no-selection class="ui-xbox ui-confirm __ ');_p(text.text(data.config.klass));__p.push('">\r\n\
        <div class="ui-shadow"></div>\r\n\
        <div class="ui-xbox-inner">\r\n\
            <div class="ui-xbox-wrap" style="height:100%">\r\n\
                <h3 class="__title ui-xbox-title">');_p(text.text(data.config.title));__p.push('</h3>\r\n\
                <div class="__content ui-xbox-cnt">\r\n\
\r\n\
                </div>\r\n\
                <div class="__buttons ui-xbox-foot">\r\n\
                    <div class="__msg ui-tips ui-tips-err" style="display:none;"></div>');$.each(data.buttons||[],function(i,btn){__p.push('                        <button data-btn-id="');_p(text.text(btn.id));__p.push('" class="');_p(text.text(btn.klass));__p.push('" type="button">');_p(text.text(btn.text));__p.push('</button>');});__p.push('                </div>\r\n\
            </div>\r\n\
            <a data-btn-id="CANCEL" class="icon-close ui-xbox-close" href="javascript:void(0)">×</a>\r\n\
        </div>\r\n\
    </div>');return __p.join("");},'alert_dialog_content':function(data){var __p=[],_p=function(s){__p.push(s)};__p.push('    ');var cls='info';switch(data.type){case'info':cls='icon-xbox-info';break;case'ok':cls='icon-xbox-ok';break;case'warn':cls='icon-xbox-warn';break;}
__p.push('    <div class="ui-confirm-cnt">\r\n\
        <i class="icon-xbox ');_p(cls);__p.push('"></i>\r\n\
        <h4 class="ui-title">');_p(data.msg||'');__p.push('</h4>\r\n\
        <div class="ui-text">');_p(data.desc||'');__p.push('</div>\r\n\
    </div>');return __p.join("");}};return tmpl;});/*  |xGv00|a24e5d678121c987b57740bdcb4dfa4d */